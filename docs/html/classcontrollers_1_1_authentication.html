<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Vireo: controllers.Authentication Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="vireo-logo-sm.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Vireo
   &#160;<span id="projectnumber">3.0.2</span>
   </div>
   <div id="projectbrief">Vireo Electronic Thesis and Dissertation Submission System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classcontrollers_1_1_authentication.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="classcontrollers_1_1_authentication-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">controllers.Authentication Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for controllers.Authentication:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication__inherit__graph.png" border="0" usemap="#controllers_8_authentication_inherit__map" alt="Inheritance graph"/></div>
<map name="controllers_8_authentication_inherit__map" id="controllers_8_authentication_inherit__map">
<area shape="rect" id="node2" href="classcontrollers_1_1_abstract_vireo_controller.html" title="{controllers.AbstractVireo\lController\n|+ context\l+ personRepo\l+ subRepo\l+ settingRepo\l+ proquestRepo\l+ errorLog\l+ stateManager\l+ indexer\l+ searcher\l+ firstUser\l|+ injectRepositories()\l+ checkForFirstUser()\l+ handleError()\l# isEmpty()\l# isNotEmpty()\l# escapeJavaScript()\l# URIEncode()\l# toJSON()\l# text2html()\l# isFieldRequired()\l}" alt="" coords="28,131,192,487"/></map>
</div>
<div class="dynheader">
Collaboration diagram for controllers.Authentication:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication__coll__graph.png" border="0" usemap="#controllers_8_authentication_coll__map" alt="Collaboration graph"/></div>
<map name="controllers_8_authentication_coll__map" id="controllers_8_authentication_coll__map">
<area shape="rect" id="node2" href="classcontrollers_1_1_abstract_vireo_controller.html" title="{controllers.AbstractVireo\lController\n|+ firstUser\l|+ injectRepositories()\l+ checkForFirstUser()\l+ handleError()\l# isEmpty()\l# isNotEmpty()\l# escapeJavaScript()\l# URIEncode()\l# toJSON()\l# text2html()\l# isFieldRequired()\l}" alt="" coords="905,1365,1069,1589"/><area shape="rect" id="node4" href="interfaceorg_1_1tdl_1_1vireo_1_1state_1_1_state_manager.html" title="{org.tdl.vireo.state.State\lManager\n||+ getState()\l+ getAllStates()\l+ getInitialState()\l+ getCancelState()\l}" alt="" coords="119,585,277,721"/><area shape="rect" id="node5" href="interfaceorg_1_1tdl_1_1vireo_1_1search_1_1_searcher.html" title="{org.tdl.vireo.search.Searcher\n||+ submissionSearch()\l+ actionLogSearch()\l+ submissionSearch()\l+ actionLogSearch()\l}" alt="" coords="302,593,491,714"/><area shape="rect" id="node6" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html" title="{org.tdl.vireo.model.Settings\lRepository\n||+ createDegree()\l+ findDegree()\l+ findDegreeByName()\l+ findAllDegrees()\l+ createMajor()\l+ findMajor()\l+ findAllMajors()\l+ createCollege()\l+ createCollege()\l+ findCollege()\l+ findCollegeByName()\l+ findAllColleges()\l+ createProgram()\l+ createProgram()\l+ findProgram()\l+ findProgramByName()\l+ findAllPrograms()\l+ createDepartment()\l+ createDepartment()\l+ findDepartment()\l+ findDepartmentByName()\l+ findAllDepartments()\l+ createAdministrativeGroup()\l+ createAdministrativeGroup()\l+ findAdministrativeGroup()\l+ findAdministrativeGroupByName()\l+ findAllAdministrativeGroups()\l+ createDocumentType()\l+ findDocumentType()\l+ findAllDocumentTypes()\l+ findAllDocumentTypes()\l+ createLanguage()\l+ findLanguage()\l+ findLanguageByName()\l+ findAllLanguages()\l+ createEmbargoType()\l+ createEmbargoType()\l+ findEmbargoType()\l+ findAllEmbargoTypes()\l+ findSystemEmbargoTypeByName\lAndGuarantor()\l+ findNonSystemEmbargoType\lByNameAndGuarantor()\l+ findAllActiveEmbargoTypes()\l+ createGraduationMonth()\l+ findGraduationMonth()\l+ findAllGraduationMonths()\l+ createCommitteeMemberRoleType()\l+ findCommitteeMemberRoleType()\l+ findAllCommitteeMemberRole\lTypes()\l+ findAllCommitteeMemberRole\lTypes()\l+ createEmailWorkflowRuleCondition()\l+ findEmailWorkflowRuleCondition()\l+ findAllEmailWorkflowRule\lConditions()\l+ createEmailWorkflowRule()\l+ findEmailWorkflowRule()\l+ findEmailWorkflowRulesBy\lState()\l+ findAllEmailWorkflowRules()\l+ createEmailTemplate()\l+ findEmailTemplate()\l+ findEmailTemplateByName()\l+ findSystemEmailTemplateByName()\l+ findNonSystemEmailTemplate\lByName()\l+ findAllEmailTemplates()\l+ createCustomActionDefinition()\l+ findCustomActionDefinition()\l+ findAllCustomActionDefinition()\l+ createConfiguration()\l+ findConfiguration()\l+ findConfigurationByName()\l+ getConfigValue()\l+ getConfigValue()\l+ getConfigBoolean()\l+ findAllConfigurations()\l+ createDepositLocation()\l+ findDepositLocation()\l+ findDepositLocationByName()\l+ findAllDepositLocations()\l}" alt="" coords="515,6,762,1301"/><area shape="rect" id="node7" href="interfaceorg_1_1tdl_1_1vireo_1_1error_1_1_error_log.html" title="{org.tdl.vireo.error.ErrorLog\n||+ logError()\l+ logError()\l+ logError()\l+ logError()\l+ getRecentErrorReports()\l+ clearRecentErrorReports()\l}" alt="" coords="787,578,974,729"/><area shape="rect" id="node8" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html" title="{org.tdl.vireo.security.Security\lContext\n||+ login()\l+ logout()\l+ getPerson()\l+ isAdministrator()\l+ isManager()\l+ isReviewer()\l+ isStudent()\l+ isAuthenticated()\l+ turnOffAuthorization()\l+ restoreAuthorization()\l+ isAuthorizationActive()\l}" alt="" coords="998,534,1190,773"/><area shape="rect" id="node9" href="interfaceorg_1_1tdl_1_1vireo_1_1search_1_1_indexer.html" title="{org.tdl.vireo.search.Indexer\n||+ updated()\l+ updated()\l+ updated()\l+ isUpdated()\l+ isUpdated()\l+ rollback()\l+ commit()\l+ rebuild()\l+ deleteAndRebuild()\l+ isJobRunning()\l+ getCurrentJobLabel()\l+ getCurrentJobProgress()\l+ getCurrentJobTotal()\l}" alt="" coords="1215,527,1394,780"/><area shape="rect" id="node10" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_submission_repository.html" title="{org.tdl.vireo.model.Submission\lRepository\n||+ createSubmission()\l+ findSubmission()\l+ findSubmissions()\l+ findSubmissionByEmailHash()\l+ findSubmission()\l+ findAllSubmissions()\l+ findSubmissionsTotal()\l+ findAllGraduationSemesters()\l+ findAllSubmissionYears()\l+ findAllPrograms()\l+ findAllColleges()\l+ findAllDepartments()\l+ findAllMajors()\l+ findAllDegrees()\l+ findAllLanguages()\l+ findAttachment()\l+ findCommitteeMember()\l+ findCustomActionValue()\l+ findActionLog()\l+ findActionLogs()\l+ findActionLog()\l+ findAllActionLogs()\l+ findActionLogsTotal()\l+ createSearchFilter()\l+ findSearchFilter()\l+ findSearchFiltersByCreator\lOrPublic()\l+ findSearchFilterByCreator\lAndName()\l+ findAllSearchFilters()\l}" alt="" coords="1419,395,1629,912"/><area shape="rect" id="node11" href="interfaceorg_1_1tdl_1_1vireo_1_1proquest_1_1_proquest_vocabulary_repository.html" title="{org.tdl.vireo.proquest.Proquest\lVocabularyRepository\n||+ findAllSubjects()\l+ findSubjectByCode()\l+ findSubjectByDescription()\l+ findAllLanguages()\l+ findLanguageByCode()\l+ findLanguageByDescription()\l+ findAllDegrees()\l+ findDegreeByCode()\l+ findDegreeByDescription()\l}" alt="" coords="1655,549,1855,758"/><area shape="rect" id="node12" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person_repository.html" title="{org.tdl.vireo.model.Person\lRepository\n||+ createPerson()\l+ findPerson()\l+ findPersonByEmail()\l+ findPersonByNetId()\l+ findPersonsByRole()\l+ searchPersons()\l+ findAllPersons()\l+ findPersonsTotal()\l+ findPreference()\l}" alt="" coords="1880,549,2054,758"/><area shape="rect" id="node13" href="interfaceorg_1_1tdl_1_1vireo_1_1email_1_1_email_service.html" title="{org.tdl.vireo.email.Email\lService\n||+ createEmail()\l+ sendEmail()\l+ isJobRunning()\l}" alt="" coords="1094,1417,1257,1538"/></map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a5181c04a9e0d7bf76a9025de1700b621"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a5181c04a9e0d7bf76a9025de1700b621">securityCheck</a> ()</td></tr>
<tr class="separator:a5181c04a9e0d7bf76a9025de1700b621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d61df5f7d791f5add98f7141f131746"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a7d61df5f7d791f5add98f7141f131746">securityCleanup</a> ()</td></tr>
<tr class="separator:a7d61df5f7d791f5add98f7141f131746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a095587b4bed7e0728d8258a37868a2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a7a095587b4bed7e0728d8258a37868a2">loginList</a> ()</td></tr>
<tr class="separator:a7a095587b4bed7e0728d8258a37868a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf6397cef8c55953e2f296e75952c599"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#adf6397cef8c55953e2f296e75952c599">loginMethod</a> (String methodName)</td></tr>
<tr class="separator:adf6397cef8c55953e2f296e75952c599"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dc7db8a593eb4e94be0809ec945ffc3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a5dc7db8a593eb4e94be0809ec945ffc3">loginReturn</a> (String methodName)</td></tr>
<tr class="separator:a5dc7db8a593eb4e94be0809ec945ffc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab24f7228fdf3f67ad806db32a274f935"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935">register</a> ()</td></tr>
<tr class="separator:ab24f7228fdf3f67ad806db32a274f935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab004894c24554ede162be6f607e1c004"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004">recover</a> ()</td></tr>
<tr class="separator:ab004894c24554ede162be6f607e1c004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f24ff7bbf5b97becb6a0cfb32d35c25"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25">profile</a> ()</td></tr>
<tr class="separator:a9f24ff7bbf5b97becb6a0cfb32d35c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c9c67e94e6cdba8b0b6f20d8109d8b3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3">updateProfile</a> ()</td></tr>
<tr class="separator:a9c9c67e94e6cdba8b0b6f20d8109d8b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1baa4b198fce87fa119f53a7a51f1ae"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae">updatePassword</a> ()</td></tr>
<tr class="separator:ab1baa4b198fce87fa119f53a7a51f1ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae9ac2b8b6ac5345c8365b4d66f5c050"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#aae9ac2b8b6ac5345c8365b4d66f5c050">logout</a> ()</td></tr>
<tr class="separator:aae9ac2b8b6ac5345c8365b4d66f5c050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classcontrollers_1_1_abstract_vireo_controller')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html">controllers.AbstractVireoController</a></td></tr>
<tr class="memitem:af33a92dee39e4e4abb1bee6fef0b6dc0 inherit pub_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#af33a92dee39e4e4abb1bee6fef0b6dc0">injectRepositories</a> ()</td></tr>
<tr class="separator:af33a92dee39e4e4abb1bee6fef0b6dc0 inherit pub_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fb44183996b4a88719fcfd5fb091729 inherit pub_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a0fb44183996b4a88719fcfd5fb091729">checkForFirstUser</a> ()</td></tr>
<tr class="separator:a0fb44183996b4a88719fcfd5fb091729 inherit pub_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae59855ceea82f6e2d83a1352f1102230 inherit pub_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#ae59855ceea82f6e2d83a1352f1102230">handleError</a> (Throwable throwable)</td></tr>
<tr class="separator:ae59855ceea82f6e2d83a1352f1102230 inherit pub_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a6656a808315ebec3c78971b6b2b501d3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1email_1_1_email_service.html">EmailService</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a6656a808315ebec3c78971b6b2b501d3">emailService</a> = Spring.getBeanOfType(EmailService.class)</td></tr>
<tr class="separator:a6656a808315ebec3c78971b6b2b501d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5faeaee32563bfbb4ba34c365376cae"><td class="memItemLeft" align="right" valign="top">static final String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#af5faeaee32563bfbb4ba34c365376cae">REGISTRATION_TEMPLATE</a> = &quot;SYSTEM New User Registration&quot;</td></tr>
<tr class="separator:af5faeaee32563bfbb4ba34c365376cae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1537cfaec5e647419e8d6496273e6e79"><td class="memItemLeft" align="right" valign="top">static final String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a1537cfaec5e647419e8d6496273e6e79">RECOVER_TEMPLATE</a> = &quot;SYSTEM Verify Email Address&quot;</td></tr>
<tr class="separator:a1537cfaec5e647419e8d6496273e6e79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html">controllers.AbstractVireoController</a></td></tr>
<tr class="memitem:a2a91bb7a42b88190f809630b9b1e7f46 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html">SecurityContext</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a> = Spring.getBeanOfType(SecurityContext.class)</td></tr>
<tr class="separator:a2a91bb7a42b88190f809630b9b1e7f46 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8388233eb6954734e3ad79d112738ee inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person_repository.html">PersonRepository</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#aa8388233eb6954734e3ad79d112738ee">personRepo</a> = Spring.getBeanOfType(PersonRepository.class)</td></tr>
<tr class="separator:aa8388233eb6954734e3ad79d112738ee inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b13e29596aa29a7dfff3690f3973ff inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_submission_repository.html">SubmissionRepository</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a55b13e29596aa29a7dfff3690f3973ff">subRepo</a> = Spring.getBeanOfType(SubmissionRepository.class)</td></tr>
<tr class="separator:a55b13e29596aa29a7dfff3690f3973ff inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2cdde9051bc152da514c18d705a196a inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html">SettingsRepository</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#aa2cdde9051bc152da514c18d705a196a">settingRepo</a> = Spring.getBeanOfType(SettingsRepository.class)</td></tr>
<tr class="separator:aa2cdde9051bc152da514c18d705a196a inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67c47dd9989ac0be630051b62b38a520 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1proquest_1_1_proquest_vocabulary_repository.html">ProquestVocabularyRepository</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a67c47dd9989ac0be630051b62b38a520">proquestRepo</a> = Spring.getBeanOfType(ProquestVocabularyRepository.class)</td></tr>
<tr class="separator:a67c47dd9989ac0be630051b62b38a520 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a220b8640fe7d439ccb7657973bc84c82 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1error_1_1_error_log.html">ErrorLog</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a220b8640fe7d439ccb7657973bc84c82">errorLog</a> = Spring.getBeanOfType(ErrorLog.class)</td></tr>
<tr class="separator:a220b8640fe7d439ccb7657973bc84c82 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a586fb3608dd548bf2c64b6c475569922 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1state_1_1_state_manager.html">StateManager</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a586fb3608dd548bf2c64b6c475569922">stateManager</a> = Spring.getBeanOfType(StateManager.class)</td></tr>
<tr class="separator:a586fb3608dd548bf2c64b6c475569922 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac64f8480f6321a3133c61c679bdbc649 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1search_1_1_indexer.html">Indexer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#ac64f8480f6321a3133c61c679bdbc649">indexer</a> = Spring.getBeanOfType(Indexer.class)</td></tr>
<tr class="separator:ac64f8480f6321a3133c61c679bdbc649 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a020e885b2789775323db0f21ed495344 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1search_1_1_searcher.html">Searcher</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a020e885b2789775323db0f21ed495344">searcher</a> = Spring.getBeanOfType(Searcher.class)</td></tr>
<tr class="separator:a020e885b2789775323db0f21ed495344 inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3d62fa6612416ab8f2b876aaf8f982c inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static Boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#aa3d62fa6612416ab8f2b876aaf8f982c">firstUser</a> = null</td></tr>
<tr class="separator:aa3d62fa6612416ab8f2b876aaf8f982c inherit pub_static_attribs_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:ab5992cfcb1bc36f3c0e954e6d9d49c0e"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#ab5992cfcb1bc36f3c0e954e6d9d49c0e">generateToken</a> (String emailAddress, String type)</td></tr>
<tr class="separator:ab5992cfcb1bc36f3c0e954e6d9d49c0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29c778467c778fbf0220b6855eaa3e2f"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a29c778467c778fbf0220b6855eaa3e2f">validateToken</a> (String token, String type)</td></tr>
<tr class="separator:a29c778467c778fbf0220b6855eaa3e2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeea97a341ec30a1a3b976b8a51f2963a"><td class="memItemLeft" align="right" valign="top">static List&lt; <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_method.html">AuthenticationMethod</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">getEnabledAuthenticationMethods</a> ()</td></tr>
<tr class="separator:aeea97a341ec30a1a3b976b8a51f2963a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac124e2f1bfb15ecab0ba3a0ad35a284f"><td class="memItemLeft" align="right" valign="top">static List&lt; <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_method.html">AuthenticationMethod</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#ac124e2f1bfb15ecab0ba3a0ad35a284f">getVisibleAuthenticationMethods</a> ()</td></tr>
<tr class="separator:ac124e2f1bfb15ecab0ba3a0ad35a284f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2e13f3a280964c8a199e1f3867630c6"><td class="memItemLeft" align="right" valign="top">static boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#ac2e13f3a280964c8a199e1f3867630c6">isRegistrationEnabled</a> ()</td></tr>
<tr class="separator:ac2e13f3a280964c8a199e1f3867630c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7679a788286c6c9756190318f7a147b"><td class="memItemLeft" align="right" valign="top">static boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#af7679a788286c6c9756190318f7a147b">isPasswordRecoveryEnabled</a> ()</td></tr>
<tr class="separator:af7679a788286c6c9756190318f7a147b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a7ddecca3ddd0a51f4ab399761125c9"><td class="memItemLeft" align="right" valign="top">static boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9">isUpdateProfileEnabled</a> (<a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html">Person</a> person)</td></tr>
<tr class="separator:a3a7ddecca3ddd0a51f4ab399761125c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c1703bd2a227a85c6443bc31fd453b"><td class="memItemLeft" align="right" valign="top">static boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b">isUpdatePasswordEnabled</a> (<a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html">Person</a> person)</td></tr>
<tr class="separator:a84c1703bd2a227a85c6443bc31fd453b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41747450a9a3100e2d516a662fc40dc7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">checkForceSSL</a> ()</td></tr>
<tr class="separator:a41747450a9a3100e2d516a662fc40dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classcontrollers_1_1_abstract_vireo_controller')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html">controllers.AbstractVireoController</a></td></tr>
<tr class="memitem:a8ff135ea8b9e9796dbef7d51b77ac233 inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a8ff135ea8b9e9796dbef7d51b77ac233">isEmpty</a> (String value)</td></tr>
<tr class="separator:a8ff135ea8b9e9796dbef7d51b77ac233 inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b14cfdcbcdada6eac4b378fd1443bf9 inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a5b14cfdcbcdada6eac4b378fd1443bf9">isNotEmpty</a> (String value)</td></tr>
<tr class="separator:a5b14cfdcbcdada6eac4b378fd1443bf9 inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c6891fcfa455d7a8aadb9aa1750c1d inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a03c6891fcfa455d7a8aadb9aa1750c1d">escapeJavaScript</a> (String value)</td></tr>
<tr class="separator:a03c6891fcfa455d7a8aadb9aa1750c1d inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a283238d203c91cfe97837c02ce587966 inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a283238d203c91cfe97837c02ce587966">URIEncode</a> (String value)</td></tr>
<tr class="separator:a283238d203c91cfe97837c02ce587966 inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0eb2078265d2db560324097ac54d2df inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#af0eb2078265d2db560324097ac54d2df">toJSON</a> (String[] values)</td></tr>
<tr class="separator:af0eb2078265d2db560324097ac54d2df inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabf7ef41b3dfa3b5da6e791cff34cc5e inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#aabf7ef41b3dfa3b5da6e791cff34cc5e">text2html</a> (String value)</td></tr>
<tr class="separator:aabf7ef41b3dfa3b5da6e791cff34cc5e inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76be37eaa99c3319f808038bc0fc63d8 inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memItemLeft" align="right" valign="top">static boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcontrollers_1_1_abstract_vireo_controller.html#a76be37eaa99c3319f808038bc0fc63d8">isFieldRequired</a> (<a class="el" href="enumorg_1_1tdl_1_1vireo_1_1constant_1_1_field_config.html">FieldConfig</a> field)</td></tr>
<tr class="separator:a76be37eaa99c3319f808038bc0fc63d8 inherit pro_static_methods_classcontrollers_1_1_abstract_vireo_controller"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classcontrollers_1_1_authentication.html">Authentication</a> controller provides, you guessed it, user authentication! Tada! In addition to the normal login and logout stuff the controller also provides new user registration, profile management, and forgot password facilities.</p>
<p>The authentication facilities use Vireo's AuthenticationMethod interface to provide plugable authentication mechanisms. You can have just method, or you can optionally provide multiple methods from which the user must pick the best one for them. The methods are broken down into two types: Implicit or Explicit. Implicit authentication methods use an external service such as Shibboleth or CAS while Explicit authentication methods are the traditional username/password just as local accounts or LDAP. This controller supports both types of methods.</p>
<dl class="section author"><dt>Author</dt><dd><a href="http://www.scottphillips.com">Scott Phillips</a> </dd></dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00051">51</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a41747450a9a3100e2d516a662fc40dc7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.checkForceSSL </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if we are forcing all authenticated sessions to be on secure SSL. If so then the user will be redirected back to the same page over SSL. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l01038">1038</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_abstract_vireo_controller_8java_source.html#l00036">controllers.AbstractVireoController.context</a>, <a class="el" href="_name_format_8java_source.html#l00013">org.tdl.vireo.model.NameFormat.FIRST_LAST</a>, and <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00140">controllers.Authentication.loginList()</a>, <a class="el" href="_authentication_8java_source.html#l00170">controllers.Authentication.loginMethod()</a>, <a class="el" href="_authentication_8java_source.html#l00604">controllers.Authentication.profile()</a>, <a class="el" href="_authentication_8java_source.html#l00485">controllers.Authentication.recover()</a>, <a class="el" href="_authentication_8java_source.html#l00335">controllers.Authentication.register()</a>, <a class="el" href="_authentication_8java_source.html#l00081">controllers.Authentication.securityCheck()</a>, <a class="el" href="_authentication_8java_source.html#l00768">controllers.Authentication.updatePassword()</a>, and <a class="el" href="_authentication_8java_source.html#l00644">controllers.Authentication.updateProfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                        {</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="comment">// Only need to check if we&#39;re not secure.</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keywordflow">if</span> (!request.secure) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;            <span class="comment">// Check if we are configured to force connections over ssl</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            String forceSSL = Play.configuration.getProperty(<span class="stringliteral">&quot;auth.forceSSL&quot;</span>, <span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            <span class="keywordflow">if</span> (<span class="stringliteral">&quot;true&quot;</span>.equalsIgnoreCase(forceSSL) || <span class="stringliteral">&quot;yes&quot;</span>.equalsIgnoreCase(forceSSL) || <span class="stringliteral">&quot;on&quot;</span>.equalsIgnoreCase(forceSSL)) {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                <span class="keywordflow">if</span> (flash.contains(<span class="stringliteral">&quot;forceSSL&quot;</span>)) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                    Logger.error(<span class="stringliteral">&quot;Detected an infinate loop while attempting to redirect to SSL because &#39;auth.forceSSL&#39; is turned on. If you are off loading SSL to a proxy make sure it is suppling the X-Forwarded-Proto header, and that the proxy&#39;s IP address is set correctly in your application.conf&#39;s XForwardSupport.&quot;</span>);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                    error(<span class="stringliteral">&quot;Unable to redirect connection to SSL.&quot;</span>);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                <span class="comment">// If the user has already logged in then something is probably wrong with the configuration. So log it.</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>() != null)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                    Logger.warn(<span class="stringliteral">&quot;%s (%d: %s) is requesting &#39;%s&#39; over insecure http, redirecting to: %s&quot;</span>,</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                            <a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>().getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>), </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                            <a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>().getId(), </div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                            <a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>().getEmail(),</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                            request.url,</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                            <span class="stringliteral">&quot;https://&quot;</span>+request.domain + request.url);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                flash.put(<span class="stringliteral">&quot;forceSSL&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                <span class="comment">// Redirect to this url using https</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                redirect(<span class="stringliteral">&quot;https://&quot;</span>+request.domain + request.url);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_abstract_vireo_controller_html_a2a91bb7a42b88190f809630b9b1e7f46"><div class="ttname"><a href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">controllers.AbstractVireoController.context</a></div><div class="ttdeci">static SecurityContext context</div><div class="ttdef"><b>Definition:</b> <a href="_abstract_vireo_controller_8java_source.html#l00036">AbstractVireoController.java:36</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format_html_a2b7e2e6dc26a8468e5af4312a3ea423a"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">org.tdl.vireo.model.NameFormat.FIRST_LAST</a></div><div class="ttdeci">FIRST_LAST</div><div class="ttdef"><b>Definition:</b> <a href="_name_format_8java_source.html#l00013">NameFormat.java:13</a></div></div>
<div class="ttc" id="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context_html_a8c6e40abd179176f16572dd321676d5e"><div class="ttname"><a href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson</a></div><div class="ttdeci">Person getPerson()</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a41747450a9a3100e2d516a662fc40dc7_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a41747450a9a3100e2d516a662fc40dc7_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a41747450a9a3100e2d516a662fc40dc7_cgraph" id="classcontrollers_1_1_authentication_a41747450a9a3100e2d516a662fc40dc7_cgraph">
<area shape="rect" id="node2" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="261,5,453,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a41747450a9a3100e2d516a662fc40dc7_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a41747450a9a3100e2d516a662fc40dc7_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a41747450a9a3100e2d516a662fc40dc7_icgraph" id="classcontrollers_1_1_authentication_a41747450a9a3100e2d516a662fc40dc7_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a7a095587b4bed7e0728d8258a37868a2" title="controllers.Authentication.loginList" alt="" coords="517,58,739,84"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#a5181c04a9e0d7bf76a9025de1700b621" title="controllers.Authentication.security\lCheck" alt="" coords="787,25,1005,66"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#adf6397cef8c55953e2f296e75952c599" title="controllers.Authentication.login\lMethod" alt="" coords="265,109,465,150"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="261,327,469,354"/><area shape="rect" id="node6" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="520,188,736,215"/><area shape="rect" id="node7" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="520,243,736,270"/><area shape="rect" id="node8" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="522,301,734,342"/><area shape="rect" id="node9" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="522,366,734,408"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab5992cfcb1bc36f3c0e954e6d9d49c0e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static String controllers.Authentication.generateToken </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>emailAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generate a secure token of an email address. The email address will be encrypted in a specific format to be decrypted by the validateToken below. When validated the email address will be returned this allows for the UI to validate a particular email address.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">emailAddress</td><td>The email address to be validated. It can contain any character other than the ":". </td></tr>
    <tr><td class="paramname">type</td><td>The purpose of for this token. This same string is needed for validating. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A base64 encoded token. </dd></dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00877">877</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00485">controllers.Authentication.recover()</a>, and <a class="el" href="_authentication_8java_source.html#l00335">controllers.Authentication.register()</a>.</p>
<div class="fragment"><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                                                                          {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">if</span> (emailAddress.contains(<span class="stringliteral">&quot;:&quot;</span>))</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Email Addresses may not contain a colon: &quot;</span>+emailAddress);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        Date now = <span class="keyword">new</span> Date();</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordtype">int</span> date = now.getYear() + now.getMonth() + now.getDate();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        String rawToken = date+<span class="stringliteral">&quot;:&quot;</span>+emailAddress+<span class="stringliteral">&quot;:&quot;</span>+type;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="comment">// Encrypt the raw token address &amp; base64 encode the result.</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            String privateKey = Play.configuration.getProperty(<span class="stringliteral">&quot;application.secret&quot;</span>).substring(0, 16);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            byte[] raw = privateKey.getBytes();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            SecretKeySpec skeySpec = <span class="keyword">new</span> SecretKeySpec(raw, <span class="stringliteral">&quot;AES&quot;</span>);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            Cipher cipher = Cipher.getInstance(<span class="stringliteral">&quot;AES&quot;</span>);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            cipher.init(Cipher.ENCRYPT_MODE, skeySpec);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">return</span> Base64.encodeBase64URLSafeString(cipher.doFinal(rawToken.getBytes()));</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        } <span class="keywordflow">catch</span> (Exception e) {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> RuntimeException(e);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_ab5992cfcb1bc36f3c0e954e6d9d49c0e_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_ab5992cfcb1bc36f3c0e954e6d9d49c0e_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_ab5992cfcb1bc36f3c0e954e6d9d49c0e_icgraph" id="classcontrollers_1_1_authentication_ab5992cfcb1bc36f3c0e954e6d9d49c0e_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="277,5,493,32"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="277,56,493,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeea97a341ec30a1a3b976b8a51f2963a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static List&lt;<a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_method.html">AuthenticationMethod</a>&gt; controllers.Authentication.getEnabledAuthenticationMethods </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The list of all enabled authenticationMethods. </dd></dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00955">955</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00968">controllers.Authentication.getVisibleAuthenticationMethods()</a>, <a class="el" href="_authentication_8java_source.html#l00993">controllers.Authentication.isPasswordRecoveryEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l00980">controllers.Authentication.isRegistrationEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l01024">controllers.Authentication.isUpdatePasswordEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l01009">controllers.Authentication.isUpdateProfileEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l00485">controllers.Authentication.recover()</a>, and <a class="el" href="_authentication_8java_source.html#l00335">controllers.Authentication.register()</a>.</p>
<div class="fragment"><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                                                                                {</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        Map&lt;String,AuthenticationMethod&gt; methodMap = Spring.getBeansOfType(AuthenticationMethod.class);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        List&lt;AuthenticationMethod&gt; enabledMethods = <span class="keyword">new</span> ArrayList&lt;AuthenticationMethod&gt;();</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keywordflow">for</span>(AuthenticationMethod method : methodMap.values()) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <span class="keywordflow">if</span> (method.isEnabled())</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                enabledMethods.add(method);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">return</span> enabledMethods;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_aeea97a341ec30a1a3b976b8a51f2963a_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_aeea97a341ec30a1a3b976b8a51f2963a_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_aeea97a341ec30a1a3b976b8a51f2963a_icgraph" id="classcontrollers_1_1_authentication_aeea97a341ec30a1a3b976b8a51f2963a_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#ac124e2f1bfb15ecab0ba3a0ad35a284f" title="controllers.Authentication.get\lVisibleAuthenticationMethods" alt="" coords="256,5,451,46"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#af7679a788286c6c9756190318f7a147b" title="controllers.Authentication.is\lPasswordRecoveryEnabled" alt="" coords="518,122,701,163"/><area shape="rect" id="node6" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="769,129,985,156"/><area shape="rect" id="node7" href="classcontrollers_1_1_authentication.html#ac2e13f3a280964c8a199e1f3867630c6" title="controllers.Authentication.is\lRegistrationEnabled" alt="" coords="518,239,701,281"/><area shape="rect" id="node8" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="769,247,985,273"/><area shape="rect" id="node9" href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b" title="controllers.Authentication.is\lUpdatePasswordEnabled" alt="" coords="262,361,445,402"/><area shape="rect" id="node13" href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9" title="controllers.Authentication.is\lUpdateProfileEnabled" alt="" coords="262,295,445,337"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#a7a095587b4bed7e0728d8258a37868a2" title="controllers.Authentication.loginList" alt="" coords="499,12,720,39"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#a5181c04a9e0d7bf76a9025de1700b621" title="controllers.Authentication.security\lCheck" alt="" coords="768,5,987,46"/><area shape="rect" id="node10" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="505,356,713,383"/><area shape="rect" id="node12" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="771,381,983,422"/><area shape="rect" id="node11" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="771,315,983,357"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac124e2f1bfb15ecab0ba3a0ad35a284f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static List&lt;<a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_method.html">AuthenticationMethod</a>&gt; controllers.Authentication.getVisibleAuthenticationMethods </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The list of all enabled and visible authenticationMethods. </dd></dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00968">968</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l00955">controllers.Authentication.getEnabledAuthenticationMethods()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00140">controllers.Authentication.loginList()</a>.</p>
<div class="fragment"><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                                                                                {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        List&lt;AuthenticationMethod&gt; visibleMethods = <span class="keyword">new</span> ArrayList&lt;AuthenticationMethod&gt;();</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="keywordflow">for</span>(AuthenticationMethod method : <a class="code" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">getEnabledAuthenticationMethods</a>()) {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <span class="keywordflow">if</span> (method.isVisible())</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                visibleMethods.add(method);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <span class="keywordflow">return</span> visibleMethods;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_aeea97a341ec30a1a3b976b8a51f2963a"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">controllers.Authentication.getEnabledAuthenticationMethods</a></div><div class="ttdeci">static List&lt; AuthenticationMethod &gt; getEnabledAuthenticationMethods()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00955">Authentication.java:955</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_ac124e2f1bfb15ecab0ba3a0ad35a284f_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_ac124e2f1bfb15ecab0ba3a0ad35a284f_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_ac124e2f1bfb15ecab0ba3a0ad35a284f_cgraph" id="classcontrollers_1_1_authentication_ac124e2f1bfb15ecab0ba3a0ad35a284f_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="248,5,451,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_ac124e2f1bfb15ecab0ba3a0ad35a284f_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_ac124e2f1bfb15ecab0ba3a0ad35a284f_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_ac124e2f1bfb15ecab0ba3a0ad35a284f_icgraph" id="classcontrollers_1_1_authentication_ac124e2f1bfb15ecab0ba3a0ad35a284f_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a7a095587b4bed7e0728d8258a37868a2" title="controllers.Authentication.loginList" alt="" coords="248,12,469,39"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#a5181c04a9e0d7bf76a9025de1700b621" title="controllers.Authentication.security\lCheck" alt="" coords="517,5,736,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af7679a788286c6c9756190318f7a147b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static boolean controllers.Authentication.isPasswordRecoveryEnabled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>If the password recovery is enabled by any authentication method. </dd></dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00993">993</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l00955">controllers.Authentication.getEnabledAuthenticationMethods()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00485">controllers.Authentication.recover()</a>.</p>
<div class="fragment"><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                                       {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        List&lt;AuthenticationMethod&gt; enabledMethods = <a class="code" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">getEnabledAuthenticationMethods</a>();</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">for</span> (AuthenticationMethod method : enabledMethods) {</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            <span class="keywordflow">if</span> (method.getAllowPasswordRecovery())</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_aeea97a341ec30a1a3b976b8a51f2963a"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">controllers.Authentication.getEnabledAuthenticationMethods</a></div><div class="ttdeci">static List&lt; AuthenticationMethod &gt; getEnabledAuthenticationMethods()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00955">Authentication.java:955</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_af7679a788286c6c9756190318f7a147b_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_af7679a788286c6c9756190318f7a147b_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_af7679a788286c6c9756190318f7a147b_cgraph" id="classcontrollers_1_1_authentication_af7679a788286c6c9756190318f7a147b_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="237,5,440,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_af7679a788286c6c9756190318f7a147b_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_af7679a788286c6c9756190318f7a147b_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_af7679a788286c6c9756190318f7a147b_icgraph" id="classcontrollers_1_1_authentication_af7679a788286c6c9756190318f7a147b_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="237,12,453,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac2e13f3a280964c8a199e1f3867630c6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static boolean controllers.Authentication.isRegistrationEnabled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>If the registration is enabled by any authentication method. </dd></dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00980">980</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l00955">controllers.Authentication.getEnabledAuthenticationMethods()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00335">controllers.Authentication.register()</a>.</p>
<div class="fragment"><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                                                   {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        List&lt;AuthenticationMethod&gt; enabledMethods = <a class="code" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">getEnabledAuthenticationMethods</a>();</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">for</span> (AuthenticationMethod method : enabledMethods) {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordflow">if</span> (method.getAllowNewRegistration())</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_aeea97a341ec30a1a3b976b8a51f2963a"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">controllers.Authentication.getEnabledAuthenticationMethods</a></div><div class="ttdeci">static List&lt; AuthenticationMethod &gt; getEnabledAuthenticationMethods()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00955">Authentication.java:955</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_ac2e13f3a280964c8a199e1f3867630c6_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_ac2e13f3a280964c8a199e1f3867630c6_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_ac2e13f3a280964c8a199e1f3867630c6_cgraph" id="classcontrollers_1_1_authentication_ac2e13f3a280964c8a199e1f3867630c6_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="237,5,440,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_ac2e13f3a280964c8a199e1f3867630c6_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_ac2e13f3a280964c8a199e1f3867630c6_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_ac2e13f3a280964c8a199e1f3867630c6_icgraph" id="classcontrollers_1_1_authentication_ac2e13f3a280964c8a199e1f3867630c6_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="237,12,453,39"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a84c1703bd2a227a85c6443bc31fd453b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static boolean controllers.Authentication.isUpdatePasswordEnabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html">Person</a>&#160;</td>
          <td class="paramname"><em>person</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">person</td><td>The person to update their password. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If this person may update their password. </dd></dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l01024">1024</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l00955">controllers.Authentication.getEnabledAuthenticationMethods()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00604">controllers.Authentication.profile()</a>, and <a class="el" href="_authentication_8java_source.html#l00768">controllers.Authentication.updatePassword()</a>.</p>
<div class="fragment"><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                                                                  {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        List&lt;AuthenticationMethod&gt; enabledMethods = <a class="code" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">getEnabledAuthenticationMethods</a>();</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="keywordflow">for</span> (AuthenticationMethod method : enabledMethods) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            <span class="keywordflow">if</span> (method.getAllowUpdatePassword(request, person))</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_aeea97a341ec30a1a3b976b8a51f2963a"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">controllers.Authentication.getEnabledAuthenticationMethods</a></div><div class="ttdeci">static List&lt; AuthenticationMethod &gt; getEnabledAuthenticationMethods()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00955">Authentication.java:955</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a84c1703bd2a227a85c6443bc31fd453b_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a84c1703bd2a227a85c6443bc31fd453b_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a84c1703bd2a227a85c6443bc31fd453b_cgraph" id="classcontrollers_1_1_authentication_a84c1703bd2a227a85c6443bc31fd453b_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="237,5,440,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a84c1703bd2a227a85c6443bc31fd453b_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a84c1703bd2a227a85c6443bc31fd453b_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a84c1703bd2a227a85c6443bc31fd453b_icgraph" id="classcontrollers_1_1_authentication_a84c1703bd2a227a85c6443bc31fd453b_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="237,115,445,141"/><area shape="rect" id="node6" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="495,173,707,214"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="493,5,709,32"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="493,56,709,83"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="495,107,707,149"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3a7ddecca3ddd0a51f4ab399761125c9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static boolean controllers.Authentication.isUpdateProfileEnabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html">Person</a>&#160;</td>
          <td class="paramname"><em>person</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">person</td><td>The person to update their profile.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If this person may update their profile information. </dd></dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l01009">1009</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l00955">controllers.Authentication.getEnabledAuthenticationMethods()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00604">controllers.Authentication.profile()</a>, and <a class="el" href="_authentication_8java_source.html#l00644">controllers.Authentication.updateProfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                                                 {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        List&lt;AuthenticationMethod&gt; enabledMethods = <a class="code" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">getEnabledAuthenticationMethods</a>();</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="keywordflow">for</span> (AuthenticationMethod method : enabledMethods) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <span class="keywordflow">if</span> (method.getAllowUpdateProfile(request, person))</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_aeea97a341ec30a1a3b976b8a51f2963a"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">controllers.Authentication.getEnabledAuthenticationMethods</a></div><div class="ttdeci">static List&lt; AuthenticationMethod &gt; getEnabledAuthenticationMethods()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00955">Authentication.java:955</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a3a7ddecca3ddd0a51f4ab399761125c9_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a3a7ddecca3ddd0a51f4ab399761125c9_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a3a7ddecca3ddd0a51f4ab399761125c9_cgraph" id="classcontrollers_1_1_authentication_a3a7ddecca3ddd0a51f4ab399761125c9_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="237,5,440,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a3a7ddecca3ddd0a51f4ab399761125c9_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a3a7ddecca3ddd0a51f4ab399761125c9_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a3a7ddecca3ddd0a51f4ab399761125c9_icgraph" id="classcontrollers_1_1_authentication_a3a7ddecca3ddd0a51f4ab399761125c9_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="237,115,445,141"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="495,173,707,214"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="493,5,709,32"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="493,56,709,83"/><area shape="rect" id="node6" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="495,107,707,149"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7a095587b4bed7e0728d8258a37868a2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.loginList </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Provide a list of authentication methods for the user to choose. If there is only one login method configured then the user is shuttled off to that authentication method without any fuss. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00140">140</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l01038">controllers.Authentication.checkForceSSL()</a>, <a class="el" href="_authentication_8java_source.html#l00968">controllers.Authentication.getVisibleAuthenticationMethods()</a>, and <a class="el" href="_authentication_8java_source.html#l00170">controllers.Authentication.loginMethod()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00081">controllers.Authentication.securityCheck()</a>.</p>
<div class="fragment"><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                   {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        flash.keep(<span class="stringliteral">&quot;url&quot;</span>);  </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">checkForceSSL</a>();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">// Get the list of all our *visible* authentication methods</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        List&lt;AuthenticationMethod&gt; visibleMethods = <a class="code" href="classcontrollers_1_1_authentication.html#ac124e2f1bfb15ecab0ba3a0ad35a284f">getVisibleAuthenticationMethods</a>();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// Fail if the admin forgot to define ANY authentication methods.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (visibleMethods.size() == 0)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            error(<span class="stringliteral">&quot;No authentication methods are defined or enabled.&quot;</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">// If there is only one option skip the list and go straight there.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">if</span> (visibleMethods.size() == 1) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="classcontrollers_1_1_authentication.html#adf6397cef8c55953e2f296e75952c599">loginMethod</a>(visibleMethods.get(0).getBeanName());</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        render(visibleMethods);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_ac124e2f1bfb15ecab0ba3a0ad35a284f"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#ac124e2f1bfb15ecab0ba3a0ad35a284f">controllers.Authentication.getVisibleAuthenticationMethods</a></div><div class="ttdeci">static List&lt; AuthenticationMethod &gt; getVisibleAuthenticationMethods()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00968">Authentication.java:968</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a41747450a9a3100e2d516a662fc40dc7"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">controllers.Authentication.checkForceSSL</a></div><div class="ttdeci">static void checkForceSSL()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01038">Authentication.java:1038</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_adf6397cef8c55953e2f296e75952c599"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#adf6397cef8c55953e2f296e75952c599">controllers.Authentication.loginMethod</a></div><div class="ttdeci">static void loginMethod(String methodName)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00170">Authentication.java:170</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a7a095587b4bed7e0728d8258a37868a2_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a7a095587b4bed7e0728d8258a37868a2_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a7a095587b4bed7e0728d8258a37868a2_cgraph" id="classcontrollers_1_1_authentication_a7a095587b4bed7e0728d8258a37868a2_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7" title="controllers.Authentication.check\lForceSSL" alt="" coords="532,70,740,111"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#ac124e2f1bfb15ecab0ba3a0ad35a284f" title="controllers.Authentication.get\lVisibleAuthenticationMethods" alt="" coords="277,9,472,50"/><area shape="rect" id="node6" href="classcontrollers_1_1_authentication.html#adf6397cef8c55953e2f296e75952c599" title="controllers.Authentication.login\lMethod" alt="" coords="275,187,475,229"/><area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="797,129,989,170"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="535,5,737,46"/><area shape="rect" id="node7" href="classcontrollers_1_1_application.html#a14ac8441c797a55a17b0741849b89a48" title="controllers.Application.index" alt="" coords="543,304,729,331"/><area shape="rect" id="node8" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_method.html#a05660a57f2e72f59ab14a4e8eea55616" title="org.tdl.vireo.security.Authentication\lMethod.isEnabled" alt="" coords="523,355,749,397"/><area shape="rect" id="node9" href="classcontrollers_1_1_authentication.html#a5dc7db8a593eb4e94be0809ec945ffc3" title="controllers.Authentication.login\lReturn" alt="" coords="536,187,736,229"/><area shape="rect" id="node10" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1" title="org.tdl.vireo.model.Abstract\lModel.getId" alt="" coords="802,221,985,262"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a7a095587b4bed7e0728d8258a37868a2_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a7a095587b4bed7e0728d8258a37868a2_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a7a095587b4bed7e0728d8258a37868a2_icgraph" id="classcontrollers_1_1_authentication_a7a095587b4bed7e0728d8258a37868a2_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a5181c04a9e0d7bf76a9025de1700b621" title="controllers.Authentication.security\lCheck" alt="" coords="275,5,493,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adf6397cef8c55953e2f296e75952c599"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.loginMethod </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>methodName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is the login page for a particular authentication method. The user will arrive from the loginList method above. There are two cases for this method either the method is Implicit or Explicit. In the Explicit case the user is presented with a login screen and when they provide a correct username/password pair they are logged in. In the Implicit case the user is redirected to authenticate via an external service.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">methodName</td><td>The spring bean name of the authentication method. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00170">170</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l01038">controllers.Authentication.checkForceSSL()</a>, <a class="el" href="_abstract_vireo_controller_8java_source.html#l00036">controllers.AbstractVireoController.context</a>, <a class="el" href="_name_format_8java_source.html#l00013">org.tdl.vireo.model.NameFormat.FIRST_LAST</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1">org.tdl.vireo.model.AbstractModel.getId()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson()</a>, <a class="el" href="_application_8java_source.html#l00028">controllers.Application.index()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_method.html#a05660a57f2e72f59ab14a4e8eea55616">org.tdl.vireo.security.AuthenticationMethod.isEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l00266">controllers.Authentication.loginReturn()</a>, and <a class="el" href="_authentication_result_8java_source.html#l00012">org.tdl.vireo.security.AuthenticationResult.SUCCESSFULL</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00140">controllers.Authentication.loginList()</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                                      {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        flash.keep(<span class="stringliteral">&quot;url&quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">checkForceSSL</a>();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        notFoundIfNull(methodName);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_cancel&quot;</span>) != null)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            Application.index();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">// Look up the authentication method and make sure it&#39;s valid.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        AuthenticationMethod method = null;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            method = (AuthenticationMethod) Spring.getBean(methodName);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        } <span class="keywordflow">catch</span> (Throwable t) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            notFound();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">if</span> (!method.isEnabled())</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            error(<span class="stringliteral">&quot;Authentication method &#39;&quot;</span>+methodName+<span class="stringliteral">&quot;&#39; is not enabled.&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">if</span> (method instanceof AuthenticationMethod.Implicit) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment">// Implicit authentication like CAS or Shibboleth</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            AuthenticationMethod.Implicit implicitMethod = (AuthenticationMethod.Implicit) method;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            Map&lt;String,Object&gt; routeArgs = <span class="keyword">new</span> HashMap&lt;String,Object&gt;();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            routeArgs.put(<span class="stringliteral">&quot;methodName&quot;</span>,methodName);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            ActionDefinition returnAction = Router.reverse(<span class="stringliteral">&quot;Authentication.loginReturn&quot;</span>, routeArgs);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            String initiationRedirect = implicitMethod.startAuthentication(request, returnAction);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">if</span> (initiationRedirect == null) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <a class="code" href="classcontrollers_1_1_authentication.html#a5dc7db8a593eb4e94be0809ec945ffc3">loginReturn</a>(methodName);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                redirect(initiationRedirect);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (method instanceof AuthenticationMethod.Explicit) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="comment">// Explicit authentication like Local Passwords or LDAP</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            AuthenticationMethod.Explicit explicitMethod = (AuthenticationMethod.Explicit) method;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_login&quot;</span>) != null) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                String username = params.get(<span class="stringliteral">&quot;username&quot;</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                String password = params.get(<span class="stringliteral">&quot;password&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                AuthenticationResult result = explicitMethod.authenticate(username, password, request);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keywordflow">if</span> (AuthenticationResult.SUCCESSFULL == result &amp;&amp; <a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>() != null) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    <span class="comment">// Log the person in.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    Person person = context.getPerson();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    session.put(<span class="stringliteral">&quot;authenticationMethod&quot;</span>, methodName);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    session.put(<span class="stringliteral">&quot;personId&quot;</span>, person.getId());</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    session.put(<span class="stringliteral">&quot;firstName&quot;</span>, person.getFirstName());</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    session.put(<span class="stringliteral">&quot;lastName&quot;</span>, person.getLastName());</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    session.put(<span class="stringliteral">&quot;displayName&quot;</span>, person.getDisplayName());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    Logger.info(<span class="stringliteral">&quot;%s (%d: %s) has logged in. Redirecting to %s.&quot;</span>,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                            person.getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>), </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                            person.getId(), </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                            person.getEmail(),</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                            flash.get(<span class="stringliteral">&quot;url&quot;</span>)==null ? <span class="stringliteral">&quot;index&quot;</span> : flash.get(<span class="stringliteral">&quot;url&quot;</span>));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    <span class="comment">// Where to go next? If there were trying to go somethere go</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    <span class="comment">// back there, otherwise go to the root.</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    <span class="keywordflow">if</span> (flash.get(<span class="stringliteral">&quot;url&quot;</span>) != null) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                        String url = flash.get(<span class="stringliteral">&quot;url&quot;</span>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        flash.remove(<span class="stringliteral">&quot;url&quot;</span>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                        <span class="keywordflow">if</span> (url != null) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                            redirect(url);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    Application.index();</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                } </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                validation.addError(<span class="stringliteral">&quot;login&quot;</span>, <span class="stringliteral">&quot;The username and/or password does not exist. Please try again.&quot;</span>);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                render(method,username,password);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            render(method);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        } </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// Neither implicit or explicit</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        error(<span class="stringliteral">&quot;Authentication method &#39;&quot;</span>+methodName+<span class="stringliteral">&quot;&#39; is invalid because it is not implicit or explicit.&quot;</span>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a41747450a9a3100e2d516a662fc40dc7"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">controllers.Authentication.checkForceSSL</a></div><div class="ttdeci">static void checkForceSSL()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01038">Authentication.java:1038</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a5dc7db8a593eb4e94be0809ec945ffc3"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a5dc7db8a593eb4e94be0809ec945ffc3">controllers.Authentication.loginReturn</a></div><div class="ttdeci">static void loginReturn(String methodName)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00266">Authentication.java:266</a></div></div>
<div class="ttc" id="classcontrollers_1_1_abstract_vireo_controller_html_a2a91bb7a42b88190f809630b9b1e7f46"><div class="ttname"><a href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">controllers.AbstractVireoController.context</a></div><div class="ttdeci">static SecurityContext context</div><div class="ttdef"><b>Definition:</b> <a href="_abstract_vireo_controller_8java_source.html#l00036">AbstractVireoController.java:36</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format_html_a2b7e2e6dc26a8468e5af4312a3ea423a"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">org.tdl.vireo.model.NameFormat.FIRST_LAST</a></div><div class="ttdeci">FIRST_LAST</div><div class="ttdef"><b>Definition:</b> <a href="_name_format_8java_source.html#l00013">NameFormat.java:13</a></div></div>
<div class="ttc" id="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context_html_a8c6e40abd179176f16572dd321676d5e"><div class="ttname"><a href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson</a></div><div class="ttdeci">Person getPerson()</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_adf6397cef8c55953e2f296e75952c599_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_adf6397cef8c55953e2f296e75952c599_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_adf6397cef8c55953e2f296e75952c599_cgraph" id="classcontrollers_1_1_authentication_adf6397cef8c55953e2f296e75952c599_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7" title="controllers.Authentication.check\lForceSSL" alt="" coords="263,5,471,46"/><area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="528,63,720,105"/><area shape="rect" id="node4" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1" title="org.tdl.vireo.model.Abstract\lModel.getId" alt="" coords="533,213,715,254"/><area shape="rect" id="node5" href="classcontrollers_1_1_application.html#a14ac8441c797a55a17b0741849b89a48" title="controllers.Application.index" alt="" coords="274,188,459,215"/><area shape="rect" id="node6" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_method.html#a05660a57f2e72f59ab14a4e8eea55616" title="org.tdl.vireo.security.Authentication\lMethod.isEnabled" alt="" coords="253,239,480,281"/><area shape="rect" id="node7" href="classcontrollers_1_1_authentication.html#a5dc7db8a593eb4e94be0809ec945ffc3" title="controllers.Authentication.login\lReturn" alt="" coords="267,122,467,163"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_adf6397cef8c55953e2f296e75952c599_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_adf6397cef8c55953e2f296e75952c599_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_adf6397cef8c55953e2f296e75952c599_icgraph" id="classcontrollers_1_1_authentication_adf6397cef8c55953e2f296e75952c599_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a7a095587b4bed7e0728d8258a37868a2" title="controllers.Authentication.loginList" alt="" coords="253,12,475,39"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#a5181c04a9e0d7bf76a9025de1700b621" title="controllers.Authentication.security\lCheck" alt="" coords="523,5,741,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5dc7db8a593eb4e94be0809ec945ffc3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.loginReturn </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>methodName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This handles returning from external authentication methods which are implicit (such as shibboleth or cas). If the credentials are valid the user is logged in, otherwise they are shuttled to another page.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">methodName</td><td>The spring bean name of the implicit authentication method </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00266">266</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_result_8java_source.html#l00025">org.tdl.vireo.security.AuthenticationResult.BAD_CREDENTIALS</a>, <a class="el" href="_abstract_vireo_controller_8java_source.html#l00036">controllers.AbstractVireoController.context</a>, <a class="el" href="_name_format_8java_source.html#l00013">org.tdl.vireo.model.NameFormat.FIRST_LAST</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1">org.tdl.vireo.model.AbstractModel.getId()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson()</a>, <a class="el" href="_authentication_result_8java_source.html#l00018">org.tdl.vireo.security.AuthenticationResult.MISSING_CREDENTIALS</a>, <a class="el" href="_authentication_result_8java_source.html#l00012">org.tdl.vireo.security.AuthenticationResult.SUCCESSFULL</a>, and <a class="el" href="_authentication_result_8java_source.html#l00030">org.tdl.vireo.security.AuthenticationResult.UNKNOWN_FAILURE</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00170">controllers.Authentication.loginMethod()</a>.</p>
<div class="fragment"><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                                      {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        flash.keep(<span class="stringliteral">&quot;url&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        notFoundIfNull(methodName);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        AuthenticationMethod.Implicit method = null;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            method = (AuthenticationMethod.Implicit) Spring.getBean(methodName);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        } <span class="keywordflow">catch</span> (Throwable t) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            notFound();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">if</span> (!method.isEnabled())</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            error(<span class="stringliteral">&quot;Authentication method &#39;&quot;</span>+methodName+<span class="stringliteral">&quot;&#39; is not enabled.&quot;</span>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        AuthenticationResult result = method.authenticate(request);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">if</span> (AuthenticationResult.SUCCESSFULL == result &amp;&amp; <a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>() != null) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="comment">// Log the person in.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            Person person = context.getPerson();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            session.put(<span class="stringliteral">&quot;authenticationMethod&quot;</span>, methodName);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            session.put(<span class="stringliteral">&quot;personId&quot;</span>, person.getId());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            session.put(<span class="stringliteral">&quot;firstName&quot;</span>, person.getFirstName());</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            session.put(<span class="stringliteral">&quot;lastName&quot;</span>, person.getLastName());</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            session.put(<span class="stringliteral">&quot;displayName&quot;</span>, person.getDisplayName());</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            Logger.info(<span class="stringliteral">&quot;%s (%d: %s) has logged in. Redirecting to %s.&quot;</span>,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    person.getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>), </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    person.getId(), </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    person.getEmail(),</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    flash.get(<span class="stringliteral">&quot;url&quot;</span>)==null ? <span class="stringliteral">&quot;index&quot;</span> : flash.get(<span class="stringliteral">&quot;url&quot;</span>));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="comment">// Where to go next? If there were trying to go somethere go</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="comment">// back there, otherwise go to the root.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">if</span> (flash.get(<span class="stringliteral">&quot;url&quot;</span>) != null &amp;&amp; flash.get(<span class="stringliteral">&quot;url&quot;</span>).trim().length() &gt; 0) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                String url = flash.get(<span class="stringliteral">&quot;url&quot;</span>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                flash.remove(<span class="stringliteral">&quot;url&quot;</span>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                redirect(url);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                Application.index();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        } </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        AuthenticationResult missing = <a class="code" href="enumorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_result.html#ad2409d3bc61fe0c76ca7b0ef6bcc440b">AuthenticationResult.MISSING_CREDENTIALS</a>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        AuthenticationResult bad = <a class="code" href="enumorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_result.html#a89911941d9f1ebd8490e05911000ccd7">AuthenticationResult.BAD_CREDENTIALS</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        AuthenticationResult unknown = <a class="code" href="enumorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_result.html#a6dd9ced84fb7e8adeacbafda6c590327">AuthenticationResult.UNKNOWN_FAILURE</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        String failureMessage = method.getFailureMessage(request, result);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        render(method, result, failureMessage, missing, bad, unknown);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_result_html_a89911941d9f1ebd8490e05911000ccd7"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_result.html#a89911941d9f1ebd8490e05911000ccd7">org.tdl.vireo.security.AuthenticationResult.BAD_CREDENTIALS</a></div><div class="ttdeci">BAD_CREDENTIALS</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_result_8java_source.html#l00025">AuthenticationResult.java:25</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_result_html_a6dd9ced84fb7e8adeacbafda6c590327"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_result.html#a6dd9ced84fb7e8adeacbafda6c590327">org.tdl.vireo.security.AuthenticationResult.UNKNOWN_FAILURE</a></div><div class="ttdeci">UNKNOWN_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_result_8java_source.html#l00030">AuthenticationResult.java:30</a></div></div>
<div class="ttc" id="classcontrollers_1_1_abstract_vireo_controller_html_a2a91bb7a42b88190f809630b9b1e7f46"><div class="ttname"><a href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">controllers.AbstractVireoController.context</a></div><div class="ttdeci">static SecurityContext context</div><div class="ttdef"><b>Definition:</b> <a href="_abstract_vireo_controller_8java_source.html#l00036">AbstractVireoController.java:36</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format_html_a2b7e2e6dc26a8468e5af4312a3ea423a"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">org.tdl.vireo.model.NameFormat.FIRST_LAST</a></div><div class="ttdeci">FIRST_LAST</div><div class="ttdef"><b>Definition:</b> <a href="_name_format_8java_source.html#l00013">NameFormat.java:13</a></div></div>
<div class="ttc" id="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context_html_a8c6e40abd179176f16572dd321676d5e"><div class="ttname"><a href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson</a></div><div class="ttdeci">Person getPerson()</div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_result_html_ad2409d3bc61fe0c76ca7b0ef6bcc440b"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_result.html#ad2409d3bc61fe0c76ca7b0ef6bcc440b">org.tdl.vireo.security.AuthenticationResult.MISSING_CREDENTIALS</a></div><div class="ttdeci">MISSING_CREDENTIALS</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_result_8java_source.html#l00018">AuthenticationResult.java:18</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a5dc7db8a593eb4e94be0809ec945ffc3_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a5dc7db8a593eb4e94be0809ec945ffc3_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a5dc7db8a593eb4e94be0809ec945ffc3_cgraph" id="classcontrollers_1_1_authentication_a5dc7db8a593eb4e94be0809ec945ffc3_cgraph">
<area shape="rect" id="node2" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1" title="org.tdl.vireo.model.Abstract\lModel.getId" alt="" coords="258,5,441,46"/><area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="253,70,445,111"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a5dc7db8a593eb4e94be0809ec945ffc3_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a5dc7db8a593eb4e94be0809ec945ffc3_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a5dc7db8a593eb4e94be0809ec945ffc3_icgraph" id="classcontrollers_1_1_authentication_a5dc7db8a593eb4e94be0809ec945ffc3_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#adf6397cef8c55953e2f296e75952c599" title="controllers.Authentication.login\lMethod" alt="" coords="253,5,453,46"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#a7a095587b4bed7e0728d8258a37868a2" title="controllers.Authentication.loginList" alt="" coords="501,12,723,39"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#a5181c04a9e0d7bf76a9025de1700b621" title="controllers.Authentication.security\lCheck" alt="" coords="771,5,989,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aae9ac2b8b6ac5345c8365b4d66f5c050"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.logout </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Logged the user out by clearing their session and sending them to the application's index page. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00824">824</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_abstract_vireo_controller_8java_source.html#l00036">controllers.AbstractVireoController.context</a>, <a class="el" href="_name_format_8java_source.html#l00013">org.tdl.vireo.model.NameFormat.FIRST_LAST</a>, and <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson()</a>.</p>
<div class="fragment"><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                                {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <span class="comment">// Check to see if the user was logged in via an implecit method.</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        AuthenticationMethod.Implicit method = null;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            String methodName = session.get(<span class="stringliteral">&quot;authenticationMethod&quot;</span>);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            method = (AuthenticationMethod.Implicit) Spring.getBean(methodName);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        } <span class="keywordflow">catch</span> (RuntimeException re) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="comment">// Ignore, the no such bean method, or a cast class exception.</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// Clear our session, effectively logging the user out of the application.</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        session.clear();</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a> != null &amp;&amp; <a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>() != null)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            Logger.info(<span class="stringliteral">&quot;%s (%d: %s) has logged out.&quot;</span>,</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                    <a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>().getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>), </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                    <a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>().getId(), </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                    <a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>().getEmail());</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordflow">if</span> (method != null) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="comment">// If the user was authenticated by an implicit authentication</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="comment">// method then allow them to logout of the external service if</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="comment">// needed.</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            ActionDefinition action = Router.reverse(<span class="stringliteral">&quot;Application.index&quot;</span>);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            action.absolute();</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            String redirect = method.logout(request, action.url);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            </div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordflow">if</span> (redirect != null )</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                redirect(redirect);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        Application.index();</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_abstract_vireo_controller_html_a2a91bb7a42b88190f809630b9b1e7f46"><div class="ttname"><a href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">controllers.AbstractVireoController.context</a></div><div class="ttdeci">static SecurityContext context</div><div class="ttdef"><b>Definition:</b> <a href="_abstract_vireo_controller_8java_source.html#l00036">AbstractVireoController.java:36</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format_html_a2b7e2e6dc26a8468e5af4312a3ea423a"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">org.tdl.vireo.model.NameFormat.FIRST_LAST</a></div><div class="ttdeci">FIRST_LAST</div><div class="ttdef"><b>Definition:</b> <a href="_name_format_8java_source.html#l00013">NameFormat.java:13</a></div></div>
<div class="ttc" id="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context_html_a8c6e40abd179176f16572dd321676d5e"><div class="ttname"><a href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson</a></div><div class="ttdeci">Person getPerson()</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_aae9ac2b8b6ac5345c8365b4d66f5c050_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_aae9ac2b8b6ac5345c8365b4d66f5c050_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_aae9ac2b8b6ac5345c8365b4d66f5c050_cgraph" id="classcontrollers_1_1_authentication_aae9ac2b8b6ac5345c8365b4d66f5c050_cgraph">
<area shape="rect" id="node2" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="261,5,453,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9f24ff7bbf5b97becb6a0cfb32d35c25"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.profile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>View the current user's profile. This is purly informational. However if configured this person will be able to follow links from this page to update their profile or their password. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00604">604</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l01038">controllers.Authentication.checkForceSSL()</a>, <a class="el" href="_name_format_8java_source.html#l00013">org.tdl.vireo.model.NameFormat.FIRST_LAST</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a6674aa143335ab5bdd3d2a95b0c5a63d">org.tdl.vireo.model.Person.getBirthYear()</a>, <a class="el" href="_authentication_8java_source.html#l01024">controllers.Authentication.isUpdatePasswordEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l01009">controllers.Authentication.isUpdateProfileEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l00768">controllers.Authentication.updatePassword()</a>, and <a class="el" href="_authentication_8java_source.html#l00644">controllers.Authentication.updateProfile()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00485">controllers.Authentication.recover()</a>, <a class="el" href="_authentication_8java_source.html#l00335">controllers.Authentication.register()</a>, <a class="el" href="_authentication_8java_source.html#l00768">controllers.Authentication.updatePassword()</a>, and <a class="el" href="_authentication_8java_source.html#l00644">controllers.Authentication.updateProfile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                 {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">checkForceSSL</a>();</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment">// Who&#39;s logged in.</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        Person person = context.getPerson();</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">// Person profile information.</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        String fullName = person.getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        String email = person.getEmail();</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        String firstName = person.getFirstName();</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        String lastName = person.getLastName();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        String middleName = person.getMiddleName();</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        String orcid = person.getOrcid();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        String birthYear = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">if</span> (person.getBirthYear() != null)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            birthYear = String.valueOf(person.getBirthYear());</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        String currentPhoneNumber = person.getCurrentPhoneNumber();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        String currentPostalAddress = person.getCurrentPostalAddress();</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        String permanentPhoneNumber = person.getPermanentPhoneNumber();</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        String permanentPostalAddress = person.getPermanentPostalAddress();</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        String permanentEmailAddress = person.getPermanentEmailAddress();</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="comment">// Update Controls</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordtype">boolean</span> <a class="code" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3">updateProfile</a> = <a class="code" href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9">isUpdateProfileEnabled</a>(person);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="keywordtype">boolean</span> <a class="code" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae">updatePassword</a> = <a class="code" href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b">isUpdatePasswordEnabled</a>(person);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        renderTemplate(<span class="stringliteral">&quot;Authentication/profile.html&quot;</span>, updateProfile, updatePassword, fullName, firstName, email, lastName, middleName, </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                birthYear, orcid, currentPhoneNumber, currentPostalAddress, permanentPhoneNumber,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                permanentPostalAddress, permanentEmailAddress);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a9c9c67e94e6cdba8b0b6f20d8109d8b3"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3">controllers.Authentication.updateProfile</a></div><div class="ttdeci">static void updateProfile()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00644">Authentication.java:644</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a84c1703bd2a227a85c6443bc31fd453b"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b">controllers.Authentication.isUpdatePasswordEnabled</a></div><div class="ttdeci">static boolean isUpdatePasswordEnabled(Person person)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01024">Authentication.java:1024</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a41747450a9a3100e2d516a662fc40dc7"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">controllers.Authentication.checkForceSSL</a></div><div class="ttdeci">static void checkForceSSL()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01038">Authentication.java:1038</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a3a7ddecca3ddd0a51f4ab399761125c9"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9">controllers.Authentication.isUpdateProfileEnabled</a></div><div class="ttdeci">static boolean isUpdateProfileEnabled(Person person)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01009">Authentication.java:1009</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format_html_a2b7e2e6dc26a8468e5af4312a3ea423a"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">org.tdl.vireo.model.NameFormat.FIRST_LAST</a></div><div class="ttdeci">FIRST_LAST</div><div class="ttdef"><b>Definition:</b> <a href="_name_format_8java_source.html#l00013">NameFormat.java:13</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_ab1baa4b198fce87fa119f53a7a51f1ae"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae">controllers.Authentication.updatePassword</a></div><div class="ttdeci">static void updatePassword()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00768">Authentication.java:768</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a9f24ff7bbf5b97becb6a0cfb32d35c25_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a9f24ff7bbf5b97becb6a0cfb32d35c25_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a9f24ff7bbf5b97becb6a0cfb32d35c25_cgraph" id="classcontrollers_1_1_authentication_a9f24ff7bbf5b97becb6a0cfb32d35c25_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7" title="controllers.Authentication.check\lForceSSL" alt="" coords="532,202,740,243"/><area shape="rect" id="node4" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a6674aa143335ab5bdd3d2a95b0c5a63d" title="org.tdl.vireo.model.Person.get\lBirthYear" alt="" coords="538,333,734,374"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b" title="controllers.Authentication.is\lUpdatePasswordEnabled" alt="" coords="545,6,727,47"/><area shape="rect" id="node7" href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9" title="controllers.Authentication.is\lUpdateProfileEnabled" alt="" coords="545,267,727,309"/><area shape="rect" id="node8" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="262,139,474,181"/><area shape="rect" id="node11" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="262,398,474,439"/><area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="803,202,995,243"/><area shape="rect" id="node6" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="797,71,1000,113"/><area shape="rect" id="node9" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a7d42d0bb053b7e58479d58f0db2620e4" title="org.tdl.vireo.model.Person.validate\lPassword" alt="" coords="525,71,747,113"/><area shape="rect" id="node10" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1" title="org.tdl.vireo.model.Abstract\lModel.getId" alt="" coords="545,137,727,178"/><area shape="rect" id="node12" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html#a66d6fe00d747507b42b9387b537322a9" title="org.tdl.vireo.model.Settings\lRepository.getConfigBoolean" alt="" coords="540,659,732,701"/><area shape="rect" id="node13" href="classorg_1_1tdl_1_1vireo_1_1services_1_1_utilities.html#aae75884abaf7bd3fd273a4b762639c9a" title="org.tdl.vireo.services.Utilities.verify\lOrcid" alt="" coords="523,725,749,766"/><area shape="rect" id="node14" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a554ff42293726bc12285071775552435" title="org.tdl.vireo.model.Person.get\lFirstName" alt="" coords="538,790,734,831"/><area shape="rect" id="node15" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0be1298e441f9a99abd909c385ca295e" title="org.tdl.vireo.model.Person.get\lMiddleName" alt="" coords="538,398,734,439"/><area shape="rect" id="node16" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#aa2263b12eee55b8a2f2f775203f61747" title="org.tdl.vireo.model.Person.get\lOrcid" alt="" coords="538,463,734,505"/><area shape="rect" id="node17" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a946a5c2d2689b7ec08292446ee8e8213" title="org.tdl.vireo.model.Person.get\lCurrentPostalAddress" alt="" coords="538,529,734,570"/><area shape="rect" id="node18" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0946389781924307bc0ca27dc123e9ad" title="org.tdl.vireo.model.Person.get\lPermanentPostalAddress" alt="" coords="538,594,734,635"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a9f24ff7bbf5b97becb6a0cfb32d35c25_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a9f24ff7bbf5b97becb6a0cfb32d35c25_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a9f24ff7bbf5b97becb6a0cfb32d35c25_icgraph" id="classcontrollers_1_1_authentication_a9f24ff7bbf5b97becb6a0cfb32d35c25_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="261,5,477,32"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="261,56,477,83"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="263,107,475,149"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="263,173,475,214"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab004894c24554ede162be6f607e1c004"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.recover </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handle recovery of lost accounts. When the user forgets their password they can use this facility to reset it after verifying their email address. This action has several different parts to complete the recovery process. By design it is very similar to DSpace's forgot password process.</p>
<p>1) Display the initial form where a user supplies their email address. If there is an account associated with the email address we send an email to the address containing a special verification token.</p>
<p>2) Display an email sent message after sending the verification email.</p>
<p>3) Upon return from a link in email ask the user to pick a password. for the required</p>
<p>4) If the return link is not valid, then display a pretty error page explaining common problems. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00485">485</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l01038">controllers.Authentication.checkForceSSL()</a>, <a class="el" href="_abstract_vireo_controller_8java_source.html#l00036">controllers.AbstractVireoController.context</a>, <a class="el" href="_authentication_8java_source.html#l00877">controllers.Authentication.generateToken()</a>, <a class="el" href="_authentication_8java_source.html#l00955">controllers.Authentication.getEnabledAuthenticationMethods()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson()</a>, <a class="el" href="_application_8java_source.html#l00028">controllers.Application.index()</a>, <a class="el" href="_authentication_8java_source.html#l00993">controllers.Authentication.isPasswordRecoveryEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l00604">controllers.Authentication.profile()</a>, <a class="el" href="_authentication_8java_source.html#l00058">controllers.Authentication.RECOVER_TEMPLATE</a>, and <a class="el" href="_authentication_8java_source.html#l00913">controllers.Authentication.validateToken()</a>.</p>
<div class="fragment"><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                 {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="comment">// Bail if we don&#39;t allow registration</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classcontrollers_1_1_authentication.html#af7679a788286c6c9756190318f7a147b">isPasswordRecoveryEnabled</a>())</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            notFound();</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">checkForceSSL</a>();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">// Bail if someone is already logged in.</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>() != null)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            Authentication.profile();</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="comment">// Bail if they&#39;ve clicked cancel.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_cancel&quot;</span>) != null)</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            Application.index();</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">// Handle returning after email verification.</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;token&quot;</span>) != null) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            String token = params.get(<span class="stringliteral">&quot;token&quot;</span>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            String email = <a class="code" href="classcontrollers_1_1_authentication.html#a29c778467c778fbf0220b6855eaa3e2f">validateToken</a>(token, <span class="stringliteral">&quot;rec&quot;</span>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordflow">if</span> (email == null)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                renderTemplate(<span class="stringliteral">&quot;Authentication/invalidToken.html&quot;</span>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            Person person = personRepo.findPersonByEmail(email);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            <span class="keywordflow">if</span> (person == null)</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                error(<span class="stringliteral">&quot;Unable to locate person object for email: &quot;</span>+email);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            String password1 = params.get(<span class="stringliteral">&quot;password1&quot;</span>);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            String password2 = params.get(<span class="stringliteral">&quot;password2&quot;</span>);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_recover&quot;</span>) != null) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="keywordflow">if</span> (password1 == null || password1.trim().length() == 0)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    validation.addError(<span class="stringliteral">&quot;password1&quot;</span>, <span class="stringliteral">&quot;Please pick a password.&quot;</span>);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="keywordflow">if</span> (password1 != null &amp;&amp; !password1.equals(password2)) </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                    validation.addError(<span class="stringliteral">&quot;password2&quot;</span>, <span class="stringliteral">&quot;The passwords do not match.&quot;</span>);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                <span class="keywordflow">if</span> (!validation.hasErrors() &amp;&amp; password1 != null &amp;&amp; password1.trim().length() &lt; 6)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    validation.addError(<span class="stringliteral">&quot;password1&quot;</span>, <span class="stringliteral">&quot;Please pick a password longer than 6 characters.&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="keywordflow">if</span> (!validation.hasErrors()) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                    </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    <span class="comment">// Update the password</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    context.login(person);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                    person.setPassword(password1);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    person.save();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                    <span class="comment">// Notify all the authentication methods of the change.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    List&lt;AuthenticationMethod&gt; methods = <a class="code" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">getEnabledAuthenticationMethods</a>();</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    <span class="keywordflow">for</span> (AuthenticationMethod method : methods) </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        method.personUpdated(request, person);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    <span class="comment">// Log the person in</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    session.put(<span class="stringliteral">&quot;personId&quot;</span>, person.getId());</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                    session.put(<span class="stringliteral">&quot;firstName&quot;</span>, person.getFirstName());</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                    session.put(<span class="stringliteral">&quot;lastName&quot;</span>, person.getLastName());</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                    session.put(<span class="stringliteral">&quot;displayName&quot;</span>, person.getDisplayName());</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                            </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                    <span class="comment">// Go to the index page.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                    Application.index();</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            renderTemplate(<span class="stringliteral">&quot;Authentication/recoverReturn.html&quot;</span>, token, email, password1, password2);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="comment">// Otherwise handle sending the email verification.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_recover&quot;</span>) != null) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            String email = params.get(<span class="stringliteral">&quot;email&quot;</span>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="keywordflow">if</span> (email == null || email.trim().length() == 0)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                validation.addError(<span class="stringliteral">&quot;email&quot;</span>, <span class="stringliteral">&quot;An email address is required.&quot;</span>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="comment">// Check if the address is valid.</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="keywordflow">if</span> (!validation.hasErrors()){</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    <span class="keyword">new</span> InternetAddress(email).validate();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                } <span class="keywordflow">catch</span> (AddressException ae) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                    validation.addError(<span class="stringliteral">&quot;email&quot;</span>, <span class="stringliteral">&quot;The email address is invalid.&quot;</span>);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="comment">// Check if the account already exists</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordflow">if</span> (!validation.hasErrors()) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                Person person = personRepo.findPersonByEmail(email);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                <span class="keywordflow">if</span> (person == null)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                    validation.addError(<span class="stringliteral">&quot;email&quot;</span>, <span class="stringliteral">&quot;No account exists with this email address.&quot;</span>);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="keywordflow">if</span> (!validation.hasErrors()) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                <span class="comment">// We&#39;re good let&#39;s send this off.</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                EmailTemplate <span class="keyword">template</span> = settingRepo.findEmailTemplateByName(<a class="code" href="classcontrollers_1_1_authentication.html#a1537cfaec5e647419e8d6496273e6e79">RECOVER_TEMPLATE</a>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                ActionDefinition action = Router.reverse(<span class="stringliteral">&quot;Authentication.recover&quot;</span>);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                action.absolute();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                String token = <a class="code" href="classcontrollers_1_1_authentication.html#ab5992cfcb1bc36f3c0e954e6d9d49c0e">generateToken</a>(email, <span class="stringliteral">&quot;rec&quot;</span>);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                VireoEmail vireoEmail = emailService.createEmail();</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                vireoEmail.setTemplate(<span class="keyword">template</span>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                vireoEmail.addParameter(<span class="stringliteral">&quot;REGISTRATION_URL&quot;</span>, action.url + <span class="stringliteral">&quot;?token=&quot;</span>+token);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                vireoEmail.addTo(email);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                emailService.sendEmail(vireoEmail,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                renderTemplate(<span class="stringliteral">&quot;Authentication/recoverSent.html&quot;</span>,email);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            renderTemplate(<span class="stringliteral">&quot;Authentication/recoverStart.html&quot;</span>,email);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        renderTemplate(<span class="stringliteral">&quot;Authentication/recoverStart.html&quot;</span>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_ab5992cfcb1bc36f3c0e954e6d9d49c0e"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#ab5992cfcb1bc36f3c0e954e6d9d49c0e">controllers.Authentication.generateToken</a></div><div class="ttdeci">static String generateToken(String emailAddress, String type)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00877">Authentication.java:877</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a29c778467c778fbf0220b6855eaa3e2f"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a29c778467c778fbf0220b6855eaa3e2f">controllers.Authentication.validateToken</a></div><div class="ttdeci">static String validateToken(String token, String type)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00913">Authentication.java:913</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a1537cfaec5e647419e8d6496273e6e79"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a1537cfaec5e647419e8d6496273e6e79">controllers.Authentication.RECOVER_TEMPLATE</a></div><div class="ttdeci">static final String RECOVER_TEMPLATE</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00058">Authentication.java:58</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a41747450a9a3100e2d516a662fc40dc7"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">controllers.Authentication.checkForceSSL</a></div><div class="ttdeci">static void checkForceSSL()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01038">Authentication.java:1038</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_af7679a788286c6c9756190318f7a147b"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#af7679a788286c6c9756190318f7a147b">controllers.Authentication.isPasswordRecoveryEnabled</a></div><div class="ttdeci">static boolean isPasswordRecoveryEnabled()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00993">Authentication.java:993</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_aeea97a341ec30a1a3b976b8a51f2963a"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">controllers.Authentication.getEnabledAuthenticationMethods</a></div><div class="ttdeci">static List&lt; AuthenticationMethod &gt; getEnabledAuthenticationMethods()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00955">Authentication.java:955</a></div></div>
<div class="ttc" id="classcontrollers_1_1_abstract_vireo_controller_html_a2a91bb7a42b88190f809630b9b1e7f46"><div class="ttname"><a href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">controllers.AbstractVireoController.context</a></div><div class="ttdeci">static SecurityContext context</div><div class="ttdef"><b>Definition:</b> <a href="_abstract_vireo_controller_8java_source.html#l00036">AbstractVireoController.java:36</a></div></div>
<div class="ttc" id="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context_html_a8c6e40abd179176f16572dd321676d5e"><div class="ttname"><a href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson</a></div><div class="ttdeci">Person getPerson()</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_ab004894c24554ede162be6f607e1c004_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_ab004894c24554ede162be6f607e1c004_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_ab004894c24554ede162be6f607e1c004_cgraph" id="classcontrollers_1_1_authentication_ab004894c24554ede162be6f607e1c004_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7" title="controllers.Authentication.check\lForceSSL" alt="" coords="812,166,1020,207"/><area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="1083,71,1275,112"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#ab5992cfcb1bc36f3c0e954e6d9d49c0e" title="controllers.Authentication.generate\lToken" alt="" coords="270,984,493,1026"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="1077,816,1280,858"/><area shape="rect" id="node6" href="classcontrollers_1_1_application.html#a14ac8441c797a55a17b0741849b89a48" title="controllers.Application.index" alt="" coords="289,1050,474,1077"/><area shape="rect" id="node7" href="classcontrollers_1_1_authentication.html#af7679a788286c6c9756190318f7a147b" title="controllers.Authentication.is\lPasswordRecoveryEnabled" alt="" coords="557,934,739,975"/><area shape="rect" id="node8" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="277,468,485,494"/><area shape="rect" id="node23" href="classcontrollers_1_1_authentication.html#a29c778467c778fbf0220b6855eaa3e2f" title="controllers.Authentication.validate\lToken" alt="" coords="272,1102,491,1143"/><area shape="rect" id="node9" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a6674aa143335ab5bdd3d2a95b0c5a63d" title="org.tdl.vireo.model.Person.get\lBirthYear" alt="" coords="818,819,1014,860"/><area shape="rect" id="node10" href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b" title="controllers.Authentication.is\lUpdatePasswordEnabled" alt="" coords="825,35,1007,76"/><area shape="rect" id="node11" href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9" title="controllers.Authentication.is\lUpdateProfileEnabled" alt="" coords="825,754,1007,795"/><area shape="rect" id="node12" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="542,254,754,295"/><area shape="rect" id="node15" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="542,460,754,502"/><area shape="rect" id="node13" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a7d42d0bb053b7e58479d58f0db2620e4" title="org.tdl.vireo.model.Person.validate\lPassword" alt="" coords="805,100,1027,142"/><area shape="rect" id="node14" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1" title="org.tdl.vireo.model.Abstract\lModel.getId" alt="" coords="825,231,1007,272"/><area shape="rect" id="node16" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html#a66d6fe00d747507b42b9387b537322a9" title="org.tdl.vireo.model.Settings\lRepository.getConfigBoolean" alt="" coords="820,427,1012,468"/><area shape="rect" id="node17" href="classorg_1_1tdl_1_1vireo_1_1services_1_1_utilities.html#aae75884abaf7bd3fd273a4b762639c9a" title="org.tdl.vireo.services.Utilities.verify\lOrcid" alt="" coords="803,492,1029,534"/><area shape="rect" id="node18" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a554ff42293726bc12285071775552435" title="org.tdl.vireo.model.Person.get\lFirstName" alt="" coords="818,558,1014,599"/><area shape="rect" id="node19" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0be1298e441f9a99abd909c385ca295e" title="org.tdl.vireo.model.Person.get\lMiddleName" alt="" coords="818,623,1014,664"/><area shape="rect" id="node20" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#aa2263b12eee55b8a2f2f775203f61747" title="org.tdl.vireo.model.Person.get\lOrcid" alt="" coords="818,688,1014,730"/><area shape="rect" id="node21" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a946a5c2d2689b7ec08292446ee8e8213" title="org.tdl.vireo.model.Person.get\lCurrentPostalAddress" alt="" coords="818,296,1014,338"/><area shape="rect" id="node22" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0946389781924307bc0ca27dc123e9ad" title="org.tdl.vireo.model.Person.get\lPermanentPostalAddress" alt="" coords="818,362,1014,403"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab24f7228fdf3f67ad806db32a274f935"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.register </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handle new account registration. This action has several different parts to complete the registration process. By design it is very similar to DSpace's registration process.</p>
<p>1) Display the initial form where a user supplies their email address. If it's valid and not already used we send an email token to it.</p>
<p>2) Display an email sent message after sending the verification email.</p>
<p>3) Upon return from a link in email ask the user for the required information: first and last names along with a password. Once validated create the account.</p>
<p>4) If the return link is not valid, then display a pretty error page explaining common problems. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00335">335</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l01038">controllers.Authentication.checkForceSSL()</a>, <a class="el" href="_abstract_vireo_controller_8java_source.html#l00036">controllers.AbstractVireoController.context</a>, <a class="el" href="_name_format_8java_source.html#l00013">org.tdl.vireo.model.NameFormat.FIRST_LAST</a>, <a class="el" href="_authentication_8java_source.html#l00877">controllers.Authentication.generateToken()</a>, <a class="el" href="_authentication_8java_source.html#l00955">controllers.Authentication.getEnabledAuthenticationMethods()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson()</a>, <a class="el" href="_application_8java_source.html#l00028">controllers.Application.index()</a>, <a class="el" href="_authentication_8java_source.html#l00980">controllers.Authentication.isRegistrationEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l00604">controllers.Authentication.profile()</a>, <a class="el" href="_authentication_8java_source.html#l00057">controllers.Authentication.REGISTRATION_TEMPLATE</a>, <a class="el" href="_role_type_8java_source.html#l00010">org.tdl.vireo.model.RoleType.STUDENT</a>, and <a class="el" href="_authentication_8java_source.html#l00913">controllers.Authentication.validateToken()</a>.</p>
<div class="fragment"><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                  {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">// Bail if we don&#39;t allow registration</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classcontrollers_1_1_authentication.html#ac2e13f3a280964c8a199e1f3867630c6">isRegistrationEnabled</a>())</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            notFound();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <a class="code" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">checkForceSSL</a>();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">// Bail if someone is already logged in.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">context</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">getPerson</a>() != null)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            Authentication.profile();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="comment">// Bail if they&#39;ve clicked cancel.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_cancel&quot;</span>) != null)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            Application.index();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">// Handle returning after email verification.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;token&quot;</span>) != null) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            String token = params.get(<span class="stringliteral">&quot;token&quot;</span>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            String email = <a class="code" href="classcontrollers_1_1_authentication.html#a29c778467c778fbf0220b6855eaa3e2f">validateToken</a>(token, <span class="stringliteral">&quot;reg&quot;</span>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="keywordflow">if</span> (email == null)</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                renderTemplate(<span class="stringliteral">&quot;Authentication/invalidToken.html&quot;</span>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="comment">// Check if the account exists.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            Person person = personRepo.findPersonByEmail(email);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            <span class="keywordflow">if</span> (person != null)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                error(<span class="stringliteral">&quot;An account for this email address already exists.&quot;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            String firstName = params.get(<span class="stringliteral">&quot;firstName&quot;</span>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            String lastName = params.get(<span class="stringliteral">&quot;lastName&quot;</span>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            String password1 = params.get(<span class="stringliteral">&quot;password1&quot;</span>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            String password2 = params.get(<span class="stringliteral">&quot;password2&quot;</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_register&quot;</span>) != null) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="keywordflow">if</span> ( (firstName == null || firstName.trim().length() == 0) &amp;&amp;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                        (lastName == null || lastName.trim().length() == 0) )</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    validation.addError(<span class="stringliteral">&quot;lastName&quot;</span>, <span class="stringliteral">&quot;Either a First or Last name is required.&quot;</span>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <span class="keywordflow">if</span> (password1 == null || password1.trim().length() == 0)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    validation.addError(<span class="stringliteral">&quot;password1&quot;</span>, <span class="stringliteral">&quot;Please pick a password.&quot;</span>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <span class="keywordflow">if</span> (password1 != null &amp;&amp; !password1.equals(password2)) </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                    validation.addError(<span class="stringliteral">&quot;password2&quot;</span>, <span class="stringliteral">&quot;The passwords do not match.&quot;</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <span class="keywordflow">if</span> (password1 != null &amp;&amp; password1.trim().length() &lt; 6)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    validation.addError(<span class="stringliteral">&quot;password1&quot;</span>, <span class="stringliteral">&quot;Please pick a password longer than 6 characters.&quot;</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <span class="keywordflow">if</span> (!validation.hasErrors()) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    <span class="comment">// Create the account.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    context.turnOffAuthorization();</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    person = personRepo.createPerson(null, email, firstName, lastName, <a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_role_type.html#abd3ec6bc08a143d0203b27b080b66738">RoleType.STUDENT</a>).save();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    person.setPassword(password1);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    person.save();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    context.turnOffAuthorization();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                    context.login(person);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    <span class="comment">// Notify all the authentication methods of the new user.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    List&lt;AuthenticationMethod&gt; methods = <a class="code" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">getEnabledAuthenticationMethods</a>();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                    <span class="keywordflow">for</span> (AuthenticationMethod method : methods) </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        method.personCreated(request, person);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    <span class="comment">// Log the person in</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    session.put(<span class="stringliteral">&quot;personId&quot;</span>, person.getId());</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    session.put(<span class="stringliteral">&quot;firstName&quot;</span>, person.getFirstName());</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    session.put(<span class="stringliteral">&quot;lastName&quot;</span>, person.getLastName());</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                    session.put(<span class="stringliteral">&quot;displayName&quot;</span>, person.getDisplayName());</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    Logger.info(<span class="stringliteral">&quot;%s (%d: %s) has registered an account. /nFirst Name = &#39;%s&#39;/nLast Name = &#39;%s&#39;/nRole Type = &#39;%s&#39;&quot;</span>,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                            person.getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>), </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                            person.getId(), </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                            person.getEmail(),</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                            person.getFirstName(),</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                            person.getLastName(),</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                            person.getRole().name());</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <span class="comment">// Go to the index page.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    Application.index();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            renderTemplate(<span class="stringliteral">&quot;Authentication/registerReturn.html&quot;</span>, token, email, firstName, lastName, password1, password2);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">// Otherwise handle sending the email verification.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_register&quot;</span>) != null) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            String email = params.get(<span class="stringliteral">&quot;email&quot;</span>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            <span class="keywordflow">if</span> (email == null || email.trim().length() == 0)</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                validation.addError(<span class="stringliteral">&quot;email&quot;</span>, <span class="stringliteral">&quot;An email address is required.&quot;</span>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="comment">// Check if the address is valid.</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keywordflow">if</span> (email != null) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    <span class="keyword">new</span> InternetAddress(email).validate();</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            } <span class="keywordflow">catch</span> (AddressException ae) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                validation.addError(<span class="stringliteral">&quot;email&quot;</span>, <span class="stringliteral">&quot;The email address is invalid.&quot;</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;            }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="comment">// Check if the account already exists</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            Person person = personRepo.findPersonByEmail(email);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordflow">if</span> (person != null)</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                validation.addError(<span class="stringliteral">&quot;email&quot;</span>, <span class="stringliteral">&quot;An account with this email address already exists.&quot;</span>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;            </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            <span class="keywordflow">if</span> (!validation.hasErrors()) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                <span class="comment">// We&#39;re good let&#39;s send this off.</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                EmailTemplate <span class="keyword">template</span> = settingRepo.findEmailTemplateByName(<a class="code" href="classcontrollers_1_1_authentication.html#af5faeaee32563bfbb4ba34c365376cae">REGISTRATION_TEMPLATE</a>);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                ActionDefinition action = Router.reverse(<span class="stringliteral">&quot;Authentication.register&quot;</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                action.absolute();</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                String token = <a class="code" href="classcontrollers_1_1_authentication.html#ab5992cfcb1bc36f3c0e954e6d9d49c0e">generateToken</a>(email, <span class="stringliteral">&quot;reg&quot;</span>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                VireoEmail vireoEmail = emailService.createEmail();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                vireoEmail.setTemplate(<span class="keyword">template</span>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                vireoEmail.addParameter(<span class="stringliteral">&quot;REGISTRATION_URL&quot;</span>, action.url + <span class="stringliteral">&quot;?token=&quot;</span>+token);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                vireoEmail.addTo(email);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                emailService.sendEmail(vireoEmail,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                renderTemplate(<span class="stringliteral">&quot;Authentication/registerSent.html&quot;</span>,email);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            renderTemplate(<span class="stringliteral">&quot;Authentication/registerStart.html&quot;</span>,email);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        renderTemplate(<span class="stringliteral">&quot;Authentication/registerStart.html&quot;</span>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_ab5992cfcb1bc36f3c0e954e6d9d49c0e"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#ab5992cfcb1bc36f3c0e954e6d9d49c0e">controllers.Authentication.generateToken</a></div><div class="ttdeci">static String generateToken(String emailAddress, String type)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00877">Authentication.java:877</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1model_1_1_role_type_html_abd3ec6bc08a143d0203b27b080b66738"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_role_type.html#abd3ec6bc08a143d0203b27b080b66738">org.tdl.vireo.model.RoleType.STUDENT</a></div><div class="ttdeci">STUDENT</div><div class="ttdef"><b>Definition:</b> <a href="_role_type_8java_source.html#l00010">RoleType.java:10</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a29c778467c778fbf0220b6855eaa3e2f"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a29c778467c778fbf0220b6855eaa3e2f">controllers.Authentication.validateToken</a></div><div class="ttdeci">static String validateToken(String token, String type)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00913">Authentication.java:913</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a41747450a9a3100e2d516a662fc40dc7"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">controllers.Authentication.checkForceSSL</a></div><div class="ttdeci">static void checkForceSSL()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01038">Authentication.java:1038</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_aeea97a341ec30a1a3b976b8a51f2963a"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a">controllers.Authentication.getEnabledAuthenticationMethods</a></div><div class="ttdeci">static List&lt; AuthenticationMethod &gt; getEnabledAuthenticationMethods()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00955">Authentication.java:955</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_ac2e13f3a280964c8a199e1f3867630c6"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#ac2e13f3a280964c8a199e1f3867630c6">controllers.Authentication.isRegistrationEnabled</a></div><div class="ttdeci">static boolean isRegistrationEnabled()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00980">Authentication.java:980</a></div></div>
<div class="ttc" id="classcontrollers_1_1_abstract_vireo_controller_html_a2a91bb7a42b88190f809630b9b1e7f46"><div class="ttname"><a href="classcontrollers_1_1_abstract_vireo_controller.html#a2a91bb7a42b88190f809630b9b1e7f46">controllers.AbstractVireoController.context</a></div><div class="ttdeci">static SecurityContext context</div><div class="ttdef"><b>Definition:</b> <a href="_abstract_vireo_controller_8java_source.html#l00036">AbstractVireoController.java:36</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format_html_a2b7e2e6dc26a8468e5af4312a3ea423a"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">org.tdl.vireo.model.NameFormat.FIRST_LAST</a></div><div class="ttdeci">FIRST_LAST</div><div class="ttdef"><b>Definition:</b> <a href="_name_format_8java_source.html#l00013">NameFormat.java:13</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_af5faeaee32563bfbb4ba34c365376cae"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#af5faeaee32563bfbb4ba34c365376cae">controllers.Authentication.REGISTRATION_TEMPLATE</a></div><div class="ttdeci">static final String REGISTRATION_TEMPLATE</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00057">Authentication.java:57</a></div></div>
<div class="ttc" id="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context_html_a8c6e40abd179176f16572dd321676d5e"><div class="ttname"><a href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e">org.tdl.vireo.security.SecurityContext.getPerson</a></div><div class="ttdeci">Person getPerson()</div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_ab24f7228fdf3f67ad806db32a274f935_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_ab24f7228fdf3f67ad806db32a274f935_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_ab24f7228fdf3f67ad806db32a274f935_cgraph" id="classcontrollers_1_1_authentication_ab24f7228fdf3f67ad806db32a274f935_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7" title="controllers.Authentication.check\lForceSSL" alt="" coords="812,166,1020,207"/><area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="1083,71,1275,112"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#ab5992cfcb1bc36f3c0e954e6d9d49c0e" title="controllers.Authentication.generate\lToken" alt="" coords="270,984,493,1026"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="1077,816,1280,858"/><area shape="rect" id="node6" href="classcontrollers_1_1_application.html#a14ac8441c797a55a17b0741849b89a48" title="controllers.Application.index" alt="" coords="289,1050,474,1077"/><area shape="rect" id="node7" href="classcontrollers_1_1_authentication.html#ac2e13f3a280964c8a199e1f3867630c6" title="controllers.Authentication.is\lRegistrationEnabled" alt="" coords="557,934,739,975"/><area shape="rect" id="node8" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="277,468,485,494"/><area shape="rect" id="node23" href="classcontrollers_1_1_authentication.html#a29c778467c778fbf0220b6855eaa3e2f" title="controllers.Authentication.validate\lToken" alt="" coords="272,1102,491,1143"/><area shape="rect" id="node9" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a6674aa143335ab5bdd3d2a95b0c5a63d" title="org.tdl.vireo.model.Person.get\lBirthYear" alt="" coords="818,819,1014,860"/><area shape="rect" id="node10" href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b" title="controllers.Authentication.is\lUpdatePasswordEnabled" alt="" coords="825,35,1007,76"/><area shape="rect" id="node11" href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9" title="controllers.Authentication.is\lUpdateProfileEnabled" alt="" coords="825,754,1007,795"/><area shape="rect" id="node12" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="542,254,754,295"/><area shape="rect" id="node15" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="542,460,754,502"/><area shape="rect" id="node13" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a7d42d0bb053b7e58479d58f0db2620e4" title="org.tdl.vireo.model.Person.validate\lPassword" alt="" coords="805,100,1027,142"/><area shape="rect" id="node14" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1" title="org.tdl.vireo.model.Abstract\lModel.getId" alt="" coords="825,231,1007,272"/><area shape="rect" id="node16" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html#a66d6fe00d747507b42b9387b537322a9" title="org.tdl.vireo.model.Settings\lRepository.getConfigBoolean" alt="" coords="820,427,1012,468"/><area shape="rect" id="node17" href="classorg_1_1tdl_1_1vireo_1_1services_1_1_utilities.html#aae75884abaf7bd3fd273a4b762639c9a" title="org.tdl.vireo.services.Utilities.verify\lOrcid" alt="" coords="803,492,1029,534"/><area shape="rect" id="node18" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a554ff42293726bc12285071775552435" title="org.tdl.vireo.model.Person.get\lFirstName" alt="" coords="818,558,1014,599"/><area shape="rect" id="node19" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0be1298e441f9a99abd909c385ca295e" title="org.tdl.vireo.model.Person.get\lMiddleName" alt="" coords="818,623,1014,664"/><area shape="rect" id="node20" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#aa2263b12eee55b8a2f2f775203f61747" title="org.tdl.vireo.model.Person.get\lOrcid" alt="" coords="818,688,1014,730"/><area shape="rect" id="node21" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a946a5c2d2689b7ec08292446ee8e8213" title="org.tdl.vireo.model.Person.get\lCurrentPostalAddress" alt="" coords="818,296,1014,338"/><area shape="rect" id="node22" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0946389781924307bc0ca27dc123e9ad" title="org.tdl.vireo.model.Person.get\lPermanentPostalAddress" alt="" coords="818,362,1014,403"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5181c04a9e0d7bf76a9025de1700b621"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.securityCheck </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method is run before every action in any controller (with the () annotation!). This method checks to see if someone has been previously authenticated and if so logs them in to the current security context. When someone is logged in their unique person id will be stored on the session as "personId". So this method simply checks that parameter and looks the user in the corresponding repository.</p>
<p>In addition if the action is annotated with a () annotation then this method will perform those minimal security checks. So if the annotation says that to access the action all users must be at least a REVIEWER then this method will check that. There are two resulting conditions, either there is no currently authenticated user or they do not meet the required access level. In the first case the user would be sent off to login, remembering where to go after completing authentication. For the other case where they are already logged in but don't meet the conditions then they will receive an unauthorized message. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00081">81</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l01038">controllers.Authentication.checkForceSSL()</a>, and <a class="el" href="_authentication_8java_source.html#l00140">controllers.Authentication.loginList()</a>.</p>
<div class="fragment"><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                       {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">// Just to make sure things are reset.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        context.logout();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="comment">// Check if we have a personId stored on the session.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        Long personId = null;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            personId = Long.valueOf(session.get(<span class="stringliteral">&quot;personId&quot;</span>));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        } <span class="keywordflow">catch</span> (RuntimeException re) { <span class="comment">/* ignore */</span> }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <span class="comment">// Log the current user in for this web request.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        Person person = null;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">if</span> (personId != null) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            person = personRepo.findPerson(personId);           </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            context.login(person);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            renderArgs.put(<span class="stringliteral">&quot;currentUser&quot;</span>,context.getPerson());</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">// Check if there are any security restrictions for this action.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        Security security = getActionAnnotation(Security.class);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">if</span> (security == null)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            security = getControllerInheritedAnnotation(Security.class);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">if</span> (security != null) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="comment">// This action has been annotated with a restriction.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">if</span> (person == null) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="comment">// No one is logged in, so let&#39;s save where we are and redirect them to authenticate.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                flash.put(<span class="stringliteral">&quot;url&quot;</span>, request.url);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <a class="code" href="classcontrollers_1_1_authentication.html#a7a095587b4bed7e0728d8258a37868a2">loginList</a>();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            RoleType expectedRole = security.value();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            RoleType actualRole = person.getRole();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordflow">if</span> (expectedRole.ordinal() &gt; actualRole.ordinal())</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                forbidden();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="comment">// If someone is authenticated, check if we need to require SSL</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (person != null)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <a class="code" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">checkForceSSL</a>();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a41747450a9a3100e2d516a662fc40dc7"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">controllers.Authentication.checkForceSSL</a></div><div class="ttdeci">static void checkForceSSL()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01038">Authentication.java:1038</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a7a095587b4bed7e0728d8258a37868a2"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a7a095587b4bed7e0728d8258a37868a2">controllers.Authentication.loginList</a></div><div class="ttdeci">static void loginList()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l00140">Authentication.java:140</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a5181c04a9e0d7bf76a9025de1700b621_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a5181c04a9e0d7bf76a9025de1700b621_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a5181c04a9e0d7bf76a9025de1700b621_cgraph" id="classcontrollers_1_1_authentication_a5181c04a9e0d7bf76a9025de1700b621_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7" title="controllers.Authentication.check\lForceSSL" alt="" coords="799,5,1007,46"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#a7a095587b4bed7e0728d8258a37868a2" title="controllers.Authentication.loginList" alt="" coords="272,101,493,128"/><area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="1064,63,1256,105"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#ac124e2f1bfb15ecab0ba3a0ad35a284f" title="controllers.Authentication.get\lVisibleAuthenticationMethods" alt="" coords="544,271,739,313"/><area shape="rect" id="node7" href="classcontrollers_1_1_authentication.html#adf6397cef8c55953e2f296e75952c599" title="controllers.Authentication.login\lMethod" alt="" coords="541,122,741,163"/><area shape="rect" id="node6" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="801,355,1004,397"/><area shape="rect" id="node8" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1" title="org.tdl.vireo.model.Abstract\lModel.getId" alt="" coords="1069,154,1251,195"/><area shape="rect" id="node9" href="classcontrollers_1_1_application.html#a14ac8441c797a55a17b0741849b89a48" title="controllers.Application.index" alt="" coords="810,239,995,265"/><area shape="rect" id="node10" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_authentication_method.html#a05660a57f2e72f59ab14a4e8eea55616" title="org.tdl.vireo.security.Authentication\lMethod.isEnabled" alt="" coords="789,290,1016,331"/><area shape="rect" id="node11" href="classcontrollers_1_1_authentication.html#a5dc7db8a593eb4e94be0809ec945ffc3" title="controllers.Authentication.login\lReturn" alt="" coords="803,122,1003,163"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7d61df5f7d791f5add98f7141f131746"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.securityCleanup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This just makes sure that the user is logged out of the current thread in all cases. Even if there is an exception the thread is closed. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00130">130</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                         {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        context.logout();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab1baa4b198fce87fa119f53a7a51f1ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.updatePassword </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update a user's password. This assumes they know their current password, if they don't then they wouldn't be logged in and could use the forgot password mechanism. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00768">768</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l01038">controllers.Authentication.checkForceSSL()</a>, <a class="el" href="_name_format_8java_source.html#l00013">org.tdl.vireo.model.NameFormat.FIRST_LAST</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1">org.tdl.vireo.model.AbstractModel.getId()</a>, <a class="el" href="_authentication_8java_source.html#l01024">controllers.Authentication.isUpdatePasswordEnabled()</a>, <a class="el" href="_authentication_8java_source.html#l00604">controllers.Authentication.profile()</a>, and <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a7d42d0bb053b7e58479d58f0db2620e4">org.tdl.vireo.model.Person.validatePassword()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00604">controllers.Authentication.profile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                                        {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <a class="code" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">checkForceSSL</a>();</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        Person person = context.getPerson();</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b">isUpdatePasswordEnabled</a>(person))</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            Authentication.profile();</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_cancel&quot;</span>) != null)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            Authentication.profile();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="comment">// Static content</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        String fullName = person.getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="comment">// Dynamic fields</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        String current = params.get(<span class="stringliteral">&quot;current&quot;</span>);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        String password1 = params.get(<span class="stringliteral">&quot;password1&quot;</span>);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        String password2 = params.get(<span class="stringliteral">&quot;password2&quot;</span>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_update&quot;</span>) != null) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="keywordflow">if</span> (current == null || current.trim().length() == 0)</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                validation.addError(<span class="stringliteral">&quot;current&quot;</span>, <span class="stringliteral">&quot;Please provide your current password.&quot;</span>);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!person.validatePassword(current))</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                validation.addError(<span class="stringliteral">&quot;current&quot;</span>, <span class="stringliteral">&quot;Your current password is not correct.&quot;</span>);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="keywordflow">if</span> (password1 == null || password1.trim().length() == 0)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                validation.addError(<span class="stringliteral">&quot;password1&quot;</span>, <span class="stringliteral">&quot;Please pick a new password.&quot;</span>);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="keywordflow">if</span> (password1 != null &amp;&amp; !password1.equals(password2)) </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                validation.addError(<span class="stringliteral">&quot;password1&quot;</span>, <span class="stringliteral">&quot;The passwords do not match.&quot;</span>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            <span class="keywordflow">if</span> (password1 != null &amp;&amp; password1.trim().length() &lt; 6)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                validation.addError(<span class="stringliteral">&quot;password1&quot;</span>, <span class="stringliteral">&quot;Please pick a new password longer than 6 characters.&quot;</span>);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <span class="keywordflow">if</span> (!validation.hasErrors()) {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                person.setPassword(password1);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                person.save();</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                Logger.info(<span class="stringliteral">&quot;%s (%d: %s) has updated their password.&quot;</span>, person.getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>), person.getId(), person.getEmail());</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                Authentication.profile();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        renderTemplate(<span class="stringliteral">&quot;Authentication/updatePassword.html&quot;</span>, fullName, password1, password2);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a84c1703bd2a227a85c6443bc31fd453b"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b">controllers.Authentication.isUpdatePasswordEnabled</a></div><div class="ttdeci">static boolean isUpdatePasswordEnabled(Person person)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01024">Authentication.java:1024</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a41747450a9a3100e2d516a662fc40dc7"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">controllers.Authentication.checkForceSSL</a></div><div class="ttdeci">static void checkForceSSL()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01038">Authentication.java:1038</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format_html_a2b7e2e6dc26a8468e5af4312a3ea423a"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">org.tdl.vireo.model.NameFormat.FIRST_LAST</a></div><div class="ttdeci">FIRST_LAST</div><div class="ttdef"><b>Definition:</b> <a href="_name_format_8java_source.html#l00013">NameFormat.java:13</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_ab1baa4b198fce87fa119f53a7a51f1ae_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_ab1baa4b198fce87fa119f53a7a51f1ae_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_ab1baa4b198fce87fa119f53a7a51f1ae_cgraph" id="classcontrollers_1_1_authentication_ab1baa4b198fce87fa119f53a7a51f1ae_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7" title="controllers.Authentication.check\lForceSSL" alt="" coords="809,65,1017,106"/><area shape="rect" id="node4" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1" title="org.tdl.vireo.model.Abstract\lModel.getId" alt="" coords="822,718,1005,759"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b" title="controllers.Authentication.is\lUpdatePasswordEnabled" alt="" coords="554,158,737,199"/><area shape="rect" id="node7" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="275,304,483,331"/><area shape="rect" id="node18" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a7d42d0bb053b7e58479d58f0db2620e4" title="org.tdl.vireo.model.Person.validate\lPassword" alt="" coords="267,494,490,535"/><area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="1080,71,1272,113"/><area shape="rect" id="node6" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="1075,6,1277,47"/><area shape="rect" id="node8" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a6674aa143335ab5bdd3d2a95b0c5a63d" title="org.tdl.vireo.model.Person.get\lBirthYear" alt="" coords="815,653,1011,694"/><area shape="rect" id="node9" href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9" title="controllers.Authentication.is\lUpdateProfileEnabled" alt="" coords="822,130,1005,171"/><area shape="rect" id="node10" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="539,326,751,367"/><area shape="rect" id="node11" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html#a66d6fe00d747507b42b9387b537322a9" title="org.tdl.vireo.model.Settings\lRepository.getConfigBoolean" alt="" coords="817,522,1009,563"/><area shape="rect" id="node12" href="classorg_1_1tdl_1_1vireo_1_1services_1_1_utilities.html#aae75884abaf7bd3fd273a4b762639c9a" title="org.tdl.vireo.services.Utilities.verify\lOrcid" alt="" coords="800,587,1027,629"/><area shape="rect" id="node13" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a554ff42293726bc12285071775552435" title="org.tdl.vireo.model.Person.get\lFirstName" alt="" coords="815,195,1011,237"/><area shape="rect" id="node14" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0be1298e441f9a99abd909c385ca295e" title="org.tdl.vireo.model.Person.get\lMiddleName" alt="" coords="815,261,1011,302"/><area shape="rect" id="node15" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#aa2263b12eee55b8a2f2f775203f61747" title="org.tdl.vireo.model.Person.get\lOrcid" alt="" coords="815,326,1011,367"/><area shape="rect" id="node16" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a946a5c2d2689b7ec08292446ee8e8213" title="org.tdl.vireo.model.Person.get\lCurrentPostalAddress" alt="" coords="815,391,1011,433"/><area shape="rect" id="node17" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0946389781924307bc0ca27dc123e9ad" title="org.tdl.vireo.model.Person.get\lPermanentPostalAddress" alt="" coords="815,457,1011,498"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_ab1baa4b198fce87fa119f53a7a51f1ae_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_ab1baa4b198fce87fa119f53a7a51f1ae_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_ab1baa4b198fce87fa119f53a7a51f1ae_icgraph" id="classcontrollers_1_1_authentication_ab1baa4b198fce87fa119f53a7a51f1ae_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="267,85,475,112"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="523,5,739,32"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="523,56,739,83"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#a9c9c67e94e6cdba8b0b6f20d8109d8b3" title="controllers.Authentication.update\lProfile" alt="" coords="525,107,737,149"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9c9c67e94e6cdba8b0b6f20d8109d8b3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void controllers.Authentication.updateProfile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Update the current user's profile information. Basically all the information other than their password: First, middle, last names, addresses, phone numbers, etc. </p>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00644">644</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>References <a class="el" href="_authentication_8java_source.html#l01038">controllers.Authentication.checkForceSSL()</a>, <a class="el" href="_name_format_8java_source.html#l00013">org.tdl.vireo.model.NameFormat.FIRST_LAST</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a6674aa143335ab5bdd3d2a95b0c5a63d">org.tdl.vireo.model.Person.getBirthYear()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html#a66d6fe00d747507b42b9387b537322a9">org.tdl.vireo.model.SettingsRepository.getConfigBoolean()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a946a5c2d2689b7ec08292446ee8e8213">org.tdl.vireo.model.Person.getCurrentPostalAddress()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a554ff42293726bc12285071775552435">org.tdl.vireo.model.Person.getFirstName()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1">org.tdl.vireo.model.AbstractModel.getId()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0be1298e441f9a99abd909c385ca295e">org.tdl.vireo.model.Person.getMiddleName()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#aa2263b12eee55b8a2f2f775203f61747">org.tdl.vireo.model.Person.getOrcid()</a>, <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0946389781924307bc0ca27dc123e9ad">org.tdl.vireo.model.Person.getPermanentPostalAddress()</a>, <a class="el" href="_authentication_8java_source.html#l01009">controllers.Authentication.isUpdateProfileEnabled()</a>, <a class="el" href="_app_config_8java_source.html#l00094">org.tdl.vireo.constant.AppConfig.ORCID_AUTHENTICATION</a>, <a class="el" href="_app_config_8java_source.html#l00091">org.tdl.vireo.constant.AppConfig.ORCID_VALIDATION</a>, <a class="el" href="_authentication_8java_source.html#l00604">controllers.Authentication.profile()</a>, <a class="el" href="_abstract_vireo_controller_8java_source.html#l00039">controllers.AbstractVireoController.settingRepo</a>, and <a class="el" href="_utilities_8java_source.html#l00119">org.tdl.vireo.services.Utilities.verifyOrcid()</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00604">controllers.Authentication.profile()</a>.</p>
<div class="fragment"><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                       {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <a class="code" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">checkForceSSL</a>();</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        Person person = context.getPerson();</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9">isUpdateProfileEnabled</a>(person))</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            todo(); <span class="comment">// Need to display static form.</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_cancel&quot;</span>) != null)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            Authentication.profile();</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">// Static content</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        String fullName = person.getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        String email = person.getEmail();</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="comment">// Dynamic fields</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        String firstName = params.get(<span class="stringliteral">&quot;firstName&quot;</span>);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        String lastName = params.get(<span class="stringliteral">&quot;lastName&quot;</span>);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        String middleName = params.get(<span class="stringliteral">&quot;middleName&quot;</span>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        String birthYear = params.get(<span class="stringliteral">&quot;birthYear&quot;</span>);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        String orcid = params.get(<span class="stringliteral">&quot;orcid&quot;</span>);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        String currentPhoneNumber = params.get(<span class="stringliteral">&quot;currentPhoneNumber&quot;</span>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        String currentPostalAddress = params.get(<span class="stringliteral">&quot;currentPostalAddress&quot;</span>);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        String permanentPhoneNumber = params.get(<span class="stringliteral">&quot;permanentPhoneNumber&quot;</span>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        String permanentPostalAddress = params.get(<span class="stringliteral">&quot;permanentPostalAddress&quot;</span>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        String permanentEmailAddress = params.get(<span class="stringliteral">&quot;permanentEmailAddress&quot;</span>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">if</span> (params.get(<span class="stringliteral">&quot;submit_update&quot;</span>) != null) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordflow">if</span> (firstName == null || firstName.trim().length() == 0)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                validation.addError(<span class="stringliteral">&quot;firstName&quot;</span>, <span class="stringliteral">&quot;First name is required.&quot;</span>);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="keywordflow">if</span> (lastName == null || lastName.trim().length() == 0)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                validation.addError(<span class="stringliteral">&quot;lastName&quot;</span>, <span class="stringliteral">&quot;Last name is required.&quot;</span>);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            Integer birthYearInt = null;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            <span class="keywordflow">if</span> (birthYear != null &amp;&amp; birthYear.trim().length() &gt; 0) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    birthYearInt = Integer.valueOf(birthYear);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                    <span class="keywordflow">if</span> (birthYearInt &lt; 1900 || birthYearInt &gt; (<span class="keyword">new</span> Date().getYear() + 1900))</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                        validation.addError(<span class="stringliteral">&quot;birthYear&quot;</span>, <span class="stringliteral">&quot;Invalid birth year, please use four digits&quot;</span>);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                } <span class="keywordflow">catch</span> (NumberFormatException nfe) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                    validation.addError(<span class="stringliteral">&quot;birthYear&quot;</span>, <span class="stringliteral">&quot;Invalid birth year.&quot;</span>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <span class="keywordflow">if</span> (permanentEmailAddress != null &amp;&amp; permanentEmailAddress.trim().length() &gt; 0) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    <span class="keyword">new</span> InternetAddress(permanentEmailAddress).validate();</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                } <span class="keywordflow">catch</span> (AddressException ae) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                    validation.addError(<span class="stringliteral">&quot;permanentEmailAddress&quot;</span>,<span class="stringliteral">&quot;Invalid permanent email address.&quot;</span>);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <span class="comment">// Verify the ORCID id by pinging their API</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keywordtype">boolean</span> orcidVerify = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#aa2cdde9051bc152da514c18d705a196a">settingRepo</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html#a66d6fe00d747507b42b9387b537322a9">getConfigBoolean</a>(AppConfig.ORCID_VALIDATION)) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classcontrollers_1_1_abstract_vireo_controller.html#aa2cdde9051bc152da514c18d705a196a">settingRepo</a>.<a class="code" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html#a66d6fe00d747507b42b9387b537322a9">getConfigBoolean</a>(AppConfig.ORCID_AUTHENTICATION))</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    orcidVerify = Utilities.verifyOrcid(orcid, person.getFirstName(), person.getLastName());</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                    orcidVerify = Utilities.verifyOrcid(orcid);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <span class="keywordflow">if</span> (!orcidVerify)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                validation.addError(<span class="stringliteral">&quot;orcid&quot;</span>,<span class="stringliteral">&quot;The provided ORCID could not be validated.&quot;</span>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="keywordflow">if</span> (!validation.hasErrors()) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                person.setFirstName(firstName);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                person.setLastName(lastName);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                person.setMiddleName(middleName);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                person.setBirthYear(birthYearInt);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                person.setCurrentPhoneNumber(currentPhoneNumber);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                person.setCurrentPostalAddress(currentPostalAddress);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                person.setPermanentPhoneNumber(permanentPhoneNumber);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                person.setPermanentPostalAddress(permanentPostalAddress);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                person.setPermanentEmailAddress(permanentEmailAddress);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                person.setOrcid(orcid);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                person.save();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                Logger.info(<span class="stringliteral">&quot;%s (%d: %s) has updated their profile. \nFirst Name = &#39;%s&#39;\nLast Name = &#39;%s&#39;\nMiddle Name = &#39;%s&#39;\nBirth Year = &#39;%d&#39;\nORCID = &#39;%s&#39;\nCurrent Phone Number = &#39;%s&#39;\nCurrent Postal Address = &#39;%s&#39;\nPermanent Phone Number = &#39;%s&#39;\nPermanent Postal Address = &#39;%s&#39;\nPermanent Email Address = &#39;%s&#39;&quot;</span>,</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                        person.getFormattedName(<a class="code" href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">NameFormat.FIRST_LAST</a>), </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                        person.getId(), </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                        person.getEmail(),</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                        person.getFirstName(),</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                        person.getLastName(),</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                        person.getMiddleName(),</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                        person.getBirthYear(),</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                        person.getOrcid(),</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                        person.getCurrentPhoneNumber(),</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                        person.getCurrentPostalAddress(),</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                        person.getPermanentPhoneNumber(),</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                        person.getPermanentPostalAddress(),</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                        person.getPermanentEmailAddress());</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                Authentication.profile();</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="comment">// First time viewing the form fill out information from the person object.</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            firstName = person.getFirstName();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            lastName = person.getLastName();</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            middleName = person.getMiddleName();</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keywordflow">if</span> (person.getBirthYear() == null)</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                birthYear = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                birthYear = String.valueOf(person.getBirthYear());</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            orcid = person.getOrcid();</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            currentPhoneNumber = person.getCurrentPhoneNumber();</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            currentPostalAddress = person.getCurrentPostalAddress();</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            permanentPhoneNumber = person.getPermanentPhoneNumber();</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            permanentPostalAddress = person.getPermanentPostalAddress();</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            permanentEmailAddress = person.getPermanentEmailAddress();</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        renderTemplate(<span class="stringliteral">&quot;Authentication/updateProfile.html&quot;</span>, fullName, firstName, email, lastName, middleName, </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                birthYear, orcid, currentPhoneNumber, currentPostalAddress, permanentPhoneNumber,</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                permanentPostalAddress, permanentEmailAddress);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    }</div>
<div class="ttc" id="classcontrollers_1_1_abstract_vireo_controller_html_aa2cdde9051bc152da514c18d705a196a"><div class="ttname"><a href="classcontrollers_1_1_abstract_vireo_controller.html#aa2cdde9051bc152da514c18d705a196a">controllers.AbstractVireoController.settingRepo</a></div><div class="ttdeci">static SettingsRepository settingRepo</div><div class="ttdef"><b>Definition:</b> <a href="_abstract_vireo_controller_8java_source.html#l00039">AbstractVireoController.java:39</a></div></div>
<div class="ttc" id="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository_html_a66d6fe00d747507b42b9387b537322a9"><div class="ttname"><a href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html#a66d6fe00d747507b42b9387b537322a9">org.tdl.vireo.model.SettingsRepository.getConfigBoolean</a></div><div class="ttdeci">boolean getConfigBoolean(String name)</div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a41747450a9a3100e2d516a662fc40dc7"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7">controllers.Authentication.checkForceSSL</a></div><div class="ttdeci">static void checkForceSSL()</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01038">Authentication.java:1038</a></div></div>
<div class="ttc" id="classcontrollers_1_1_authentication_html_a3a7ddecca3ddd0a51f4ab399761125c9"><div class="ttname"><a href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9">controllers.Authentication.isUpdateProfileEnabled</a></div><div class="ttdeci">static boolean isUpdateProfileEnabled(Person person)</div><div class="ttdef"><b>Definition:</b> <a href="_authentication_8java_source.html#l01009">Authentication.java:1009</a></div></div>
<div class="ttc" id="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format_html_a2b7e2e6dc26a8468e5af4312a3ea423a"><div class="ttname"><a href="enumorg_1_1tdl_1_1vireo_1_1model_1_1_name_format.html#a2b7e2e6dc26a8468e5af4312a3ea423a">org.tdl.vireo.model.NameFormat.FIRST_LAST</a></div><div class="ttdeci">FIRST_LAST</div><div class="ttdef"><b>Definition:</b> <a href="_name_format_8java_source.html#l00013">NameFormat.java:13</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a9c9c67e94e6cdba8b0b6f20d8109d8b3_cgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a9c9c67e94e6cdba8b0b6f20d8109d8b3_cgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a9c9c67e94e6cdba8b0b6f20d8109d8b3_cgraph" id="classcontrollers_1_1_authentication_a9c9c67e94e6cdba8b0b6f20d8109d8b3_cgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a41747450a9a3100e2d516a662fc40dc7" title="controllers.Authentication.check\lForceSSL" alt="" coords="811,194,1019,235"/><area shape="rect" id="node4" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a6674aa143335ab5bdd3d2a95b0c5a63d" title="org.tdl.vireo.model.Person.get\lBirthYear" alt="" coords="550,239,746,281"/><area shape="rect" id="node5" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_settings_repository.html#a66d6fe00d747507b42b9387b537322a9" title="org.tdl.vireo.model.Settings\lRepository.getConfigBoolean" alt="" coords="284,407,476,449"/><area shape="rect" id="node6" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a946a5c2d2689b7ec08292446ee8e8213" title="org.tdl.vireo.model.Person.get\lCurrentPostalAddress" alt="" coords="282,473,478,514"/><area shape="rect" id="node7" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a554ff42293726bc12285071775552435" title="org.tdl.vireo.model.Person.get\lFirstName" alt="" coords="282,538,478,579"/><area shape="rect" id="node8" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_abstract_model.html#adf9b6814dd10bc0848d4f17341c6e7b1" title="org.tdl.vireo.model.Abstract\lModel.getId" alt="" coords="823,303,1006,345"/><area shape="rect" id="node9" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0be1298e441f9a99abd909c385ca295e" title="org.tdl.vireo.model.Person.get\lMiddleName" alt="" coords="282,603,478,645"/><area shape="rect" id="node10" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#aa2263b12eee55b8a2f2f775203f61747" title="org.tdl.vireo.model.Person.get\lOrcid" alt="" coords="282,669,478,710"/><area shape="rect" id="node11" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a0946389781924307bc0ca27dc123e9ad" title="org.tdl.vireo.model.Person.get\lPermanentPostalAddress" alt="" coords="282,734,478,775"/><area shape="rect" id="node12" href="classcontrollers_1_1_authentication.html#a3a7ddecca3ddd0a51f4ab399761125c9" title="controllers.Authentication.is\lUpdateProfileEnabled" alt="" coords="557,5,739,46"/><area shape="rect" id="node14" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="276,159,484,185"/><area shape="rect" id="node18" href="classorg_1_1tdl_1_1vireo_1_1services_1_1_utilities.html#aae75884abaf7bd3fd273a4b762639c9a" title="org.tdl.vireo.services.Utilities.verify\lOrcid" alt="" coords="267,799,493,841"/><area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1security_1_1_security_context.html#a8c6e40abd179176f16572dd321676d5e" title="org.tdl.vireo.security.Security\lContext.getPerson" alt="" coords="1080,194,1272,235"/><area shape="rect" id="node13" href="classcontrollers_1_1_authentication.html#aeea97a341ec30a1a3b976b8a51f2963a" title="controllers.Authentication.get\lEnabledAuthenticationMethods" alt="" coords="1075,34,1277,75"/><area shape="rect" id="node15" href="classcontrollers_1_1_authentication.html#a84c1703bd2a227a85c6443bc31fd453b" title="controllers.Authentication.is\lUpdatePasswordEnabled" alt="" coords="823,63,1006,105"/><area shape="rect" id="node16" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="542,122,754,163"/><area shape="rect" id="node17" href="interfaceorg_1_1tdl_1_1vireo_1_1model_1_1_person.html#a7d42d0bb053b7e58479d58f0db2620e4" title="org.tdl.vireo.model.Person.validate\lPassword" alt="" coords="803,129,1026,170"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a9c9c67e94e6cdba8b0b6f20d8109d8b3_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a9c9c67e94e6cdba8b0b6f20d8109d8b3_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a9c9c67e94e6cdba8b0b6f20d8109d8b3_icgraph" id="classcontrollers_1_1_authentication_a9c9c67e94e6cdba8b0b6f20d8109d8b3_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#a9f24ff7bbf5b97becb6a0cfb32d35c25" title="controllers.Authentication.profile" alt="" coords="267,85,475,112"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="523,5,739,32"/><area shape="rect" id="node4" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="523,56,739,83"/><area shape="rect" id="node5" href="classcontrollers_1_1_authentication.html#ab1baa4b198fce87fa119f53a7a51f1ae" title="controllers.Authentication.update\lPassword" alt="" coords="525,107,737,149"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a29c778467c778fbf0220b6855eaa3e2f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static String controllers.Authentication.validateToken </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Decrypt and validate a token. The embedded email address encoded in the token will be returned. The same type string that was used when producing the token must be used, typically either "register" or "forgot".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">token</td><td>The base64 encoded token. </td></tr>
    <tr><td class="paramname">type</td><td>The purpose of this token. The same string is needed that generated the token. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The embedded email address. </dd></dl>

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00913">913</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00485">controllers.Authentication.recover()</a>, and <a class="el" href="_authentication_8java_source.html#l00335">controllers.Authentication.register()</a>.</p>
<div class="fragment"><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                                                                   {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        String rawToken = null;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            String privateKey = Play.configuration.getProperty(<span class="stringliteral">&quot;application.secret&quot;</span>).substring(0, 16);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            byte[] raw = privateKey.getBytes();</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            SecretKeySpec skeySpec = <span class="keyword">new</span> SecretKeySpec(raw, <span class="stringliteral">&quot;AES&quot;</span>);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            Cipher cipher = Cipher.getInstance(<span class="stringliteral">&quot;AES&quot;</span>);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;            cipher.init(Cipher.DECRYPT_MODE, skeySpec);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;            rawToken = <span class="keyword">new</span> String(cipher.doFinal(Base64.decodeBase64(token)));</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        } <span class="keywordflow">catch</span> (Exception e) {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="comment">// Any error should just return null. </span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <span class="keywordflow">return</span> null;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">// Check that we were able to decrypt something.</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="keywordflow">if</span> (rawToken == null)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <span class="keywordflow">return</span> null;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="comment">// Check that we have the three parts of the rawToken.</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        String[] parts = rawToken.split(<span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">if</span> (parts.length != 3)</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <span class="keywordflow">return</span> null;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment">// Check that the token was generated today or yesterday.</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        Date now = <span class="keyword">new</span> Date();</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <span class="keywordtype">int</span> date = now.getYear() + now.getMonth() + now.getDate();</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="keywordflow">if</span> (!(String.valueOf(date).equals(parts[0]) ||</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            String.valueOf(date-1).equals(parts[0])))</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <span class="keywordflow">return</span> null;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="comment">// Check that the token is of the expected type.</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">if</span> (!type.equals(parts[2]))</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <span class="keywordflow">return</span> null;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        <span class="comment">// All checks passed, return the email address.</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <span class="keywordflow">return</span> parts[1];</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    }</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classcontrollers_1_1_authentication_a29c778467c778fbf0220b6855eaa3e2f_icgraph.png" border="0" usemap="#classcontrollers_1_1_authentication_a29c778467c778fbf0220b6855eaa3e2f_icgraph" alt=""/></div>
<map name="classcontrollers_1_1_authentication_a29c778467c778fbf0220b6855eaa3e2f_icgraph" id="classcontrollers_1_1_authentication_a29c778467c778fbf0220b6855eaa3e2f_icgraph">
<area shape="rect" id="node2" href="classcontrollers_1_1_authentication.html#ab004894c24554ede162be6f607e1c004" title="controllers.Authentication.recover" alt="" coords="272,5,488,32"/><area shape="rect" id="node3" href="classcontrollers_1_1_authentication.html#ab24f7228fdf3f67ad806db32a274f935" title="controllers.Authentication.register" alt="" coords="272,56,488,83"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a6656a808315ebec3c78971b6b2b501d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1email_1_1_email_service.html">EmailService</a> controllers.Authentication.emailService = Spring.getBeanOfType(EmailService.class)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00054">54</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

</div>
</div>
<a class="anchor" id="a1537cfaec5e647419e8d6496273e6e79"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">final String controllers.Authentication.RECOVER_TEMPLATE = &quot;SYSTEM Verify Email Address&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00058">58</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00485">controllers.Authentication.recover()</a>.</p>

</div>
</div>
<a class="anchor" id="af5faeaee32563bfbb4ba34c365376cae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">final String controllers.Authentication.REGISTRATION_TEMPLATE = &quot;SYSTEM New User Registration&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_authentication_8java_source.html#l00057">57</a> of file <a class="el" href="_authentication_8java_source.html">Authentication.java</a>.</p>

<p>Referenced by <a class="el" href="_authentication_8java_source.html#l00335">controllers.Authentication.register()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>app/controllers/<a class="el" href="_authentication_8java_source.html">Authentication.java</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecontrollers.html">controllers</a></li><li class="navelem"><a class="el" href="classcontrollers_1_1_authentication.html">Authentication</a></li>
    <li class="footer">Generated on Fri May 1 2015 10:53:26 for Vireo by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
