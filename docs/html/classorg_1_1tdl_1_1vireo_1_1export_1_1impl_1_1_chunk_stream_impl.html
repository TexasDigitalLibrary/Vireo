<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Vireo: org.tdl.vireo.export.impl.ChunkStreamImpl Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Vireo
   &#160;<span id="projectnumber">3.0.x-RC</span>
   </div>
   <div id="projectbrief">Vireo Electronic Thesis and Dissertation Submission System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">org.tdl.vireo.export.impl.ChunkStreamImpl Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for org.tdl.vireo.export.impl.ChunkStreamImpl:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl__inherit__graph.png" border="0" usemap="#org_8tdl_8vireo_8export_8impl_8_chunk_stream_impl_inherit__map" alt="Inheritance graph"/></div>
<map name="org_8tdl_8vireo_8export_8impl_8_chunk_stream_impl_inherit__map" id="org_8tdl_8vireo_8export_8impl_8_chunk_stream_impl_inherit__map">
<area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1export_1_1_chunk_stream.html" title="org.tdl.vireo.export.Chunk\lStream" alt="" coords="131,6,303,47"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for org.tdl.vireo.export.impl.ChunkStreamImpl:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl__coll__graph.png" border="0" usemap="#org_8tdl_8vireo_8export_8impl_8_chunk_stream_impl_coll__map" alt="Collaboration graph"/></div>
<map name="org_8tdl_8vireo_8export_8impl_8_chunk_stream_impl_coll__map" id="org_8tdl_8vireo_8export_8impl_8_chunk_stream_impl_coll__map">
<area shape="rect" id="node3" href="interfaceorg_1_1tdl_1_1vireo_1_1export_1_1_chunk_stream.html" title="org.tdl.vireo.export.Chunk\lStream" alt="" coords="6,57,178,98"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_1_1_buffer_full_exception.html">BufferFullException</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5d06dc687596e22ebdc1f5d885579488"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a5d06dc687596e22ebdc1f5d885579488">ChunkStreamImpl</a> (String <a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#af452fbad8af098c29a6f0f6a1d2c4c5a">contentType</a>, String <a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a533f24fd9754df388267808b7784b512">contentDisposition</a>, int <a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a59ab74694056b1600d983ddade54c626">bufferSize</a>)</td></tr>
<tr class="separator:a5d06dc687596e22ebdc1f5d885579488"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7525dd840127d55ed526dbbfd3ffabd2"><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a7525dd840127d55ed526dbbfd3ffabd2">getContentType</a> ()</td></tr>
<tr class="separator:a7525dd840127d55ed526dbbfd3ffabd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b858c6f25e8413e77f7a6f9cdb996d9"><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a4b858c6f25e8413e77f7a6f9cdb996d9">getContentDisposition</a> ()</td></tr>
<tr class="separator:a4b858c6f25e8413e77f7a6f9cdb996d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b23dfcf57096c42713079bf1c7d38e9"><td class="memItemLeft" align="right" valign="top">synchronized void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a0b23dfcf57096c42713079bf1c7d38e9">close</a> ()</td></tr>
<tr class="separator:a0b23dfcf57096c42713079bf1c7d38e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51b84292fe39bf214568aef4b79af00e"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a51b84292fe39bf214568aef4b79af00e">hasNextChunk</a> ()</td></tr>
<tr class="separator:a51b84292fe39bf214568aef4b79af00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2122fdfd1eb48b770a451b20da35c889"><td class="memItemLeft" align="right" valign="top">synchronized Promise&lt; byte[]&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">nextChunk</a> ()</td></tr>
<tr class="separator:a2122fdfd1eb48b770a451b20da35c889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fdd75f1603b61239c578b9c3bd046a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a8fdd75f1603b61239c578b9c3bd046a7">write</a> (int b)  throws IOException </td></tr>
<tr class="separator:a8fdd75f1603b61239c578b9c3bd046a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab506d72a80464c94c425b4d4be13c16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#aab506d72a80464c94c425b4d4be13c16">write</a> (byte[] b)  throws IOException </td></tr>
<tr class="separator:aab506d72a80464c94c425b4d4be13c16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a919e029252817ed3af4a6fcff25ec6a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a919e029252817ed3af4a6fcff25ec6a5">write</a> (byte[] b, int off, int len)  throws IOException </td></tr>
<tr class="separator:a919e029252817ed3af4a6fcff25ec6a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f79482a09d7550ee6b32c95c9af079"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab2f79482a09d7550ee6b32c95c9af079">flush</a> ()</td></tr>
<tr class="separator:ab2f79482a09d7550ee6b32c95c9af079"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:af452fbad8af098c29a6f0f6a1d2c4c5a"><td class="memItemLeft" align="right" valign="top">final String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#af452fbad8af098c29a6f0f6a1d2c4c5a">contentType</a></td></tr>
<tr class="separator:af452fbad8af098c29a6f0f6a1d2c4c5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a533f24fd9754df388267808b7784b512"><td class="memItemLeft" align="right" valign="top">final String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a533f24fd9754df388267808b7784b512">contentDisposition</a></td></tr>
<tr class="separator:a533f24fd9754df388267808b7784b512"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a159d7996f1a9ac5bfd83ce95245ffe6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f">writeOrWait</a> (byte[] event)  throws IOException </td></tr>
<tr class="separator:a159d7996f1a9ac5bfd83ce95245ffe6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a59ab74694056b1600d983ddade54c626"><td class="memItemLeft" align="right" valign="top">final int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a59ab74694056b1600d983ddade54c626">bufferSize</a></td></tr>
<tr class="separator:a59ab74694056b1600d983ddade54c626"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c52fe3ab2632b0394f7d0e34ad7c0b"><td class="memItemLeft" align="right" valign="top">final ConcurrentLinkedQueue<br class="typebreak"/>
&lt; byte[]&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab1c52fe3ab2632b0394f7d0e34ad7c0b">chunks</a> = new ConcurrentLinkedQueue&lt;byte[]&gt;()</td></tr>
<tr class="separator:ab1c52fe3ab2632b0394f7d0e34ad7c0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3394937414ecae30edf9ddd659d4b25"><td class="memItemLeft" align="right" valign="top">Promise&lt; byte[]&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab3394937414ecae30edf9ddd659d4b25">nextChunk</a></td></tr>
<tr class="separator:ab3394937414ecae30edf9ddd659d4b25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b7a6f5e530d8408c20e6f7c25d82841"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a0b7a6f5e530d8408c20e6f7c25d82841">open</a></td></tr>
<tr class="separator:a0b7a6f5e530d8408c20e6f7c25d82841"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a939d18dc7cfb2af53de90c51ff493e63"><td class="memItemLeft" align="right" valign="top">synchronized void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a939d18dc7cfb2af53de90c51ff493e63">synchronizedWrite</a> (byte[] event)  throws BufferFullException, IOException </td></tr>
<tr class="separator:a939d18dc7cfb2af53de90c51ff493e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Okay, this is awesome!</p>
<p>This class is an output stream, that can produce play style promises for chunked content. This means that anytime we want to do file IO we can use this class to stream that file directly to the browser. Play is really powerful.</p>
<dl class="section author"><dt>Author</dt><dd><a href="http://www.scottphillips.com">Scott Phillips</a> </dd></dl>

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00021">21</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a5d06dc687596e22ebdc1f5d885579488"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">org.tdl.vireo.export.impl.ChunkStreamImpl.ChunkStreamImpl </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>contentType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>contentDisposition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bufferSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Construct a new chunk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">contentType</td><td>The content type, typically "application/zip". </td></tr>
    <tr><td class="paramname">contentDisposition</td><td>The content disposition, typically "attachment; filename=[name]" </td></tr>
    <tr><td class="paramname">bufferSize</td><td>The maximum size of chunks to keep in the queue before throtteling the producer. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00051">51</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00028">org.tdl.vireo.export.impl.ChunkStreamImpl.bufferSize</a>, <a class="el" href="_chunk_stream_impl_8java_source.html#l00025">org.tdl.vireo.export.impl.ChunkStreamImpl.contentDisposition</a>, and <a class="el" href="_chunk_stream_impl_8java_source.html#l00024">org.tdl.vireo.export.impl.ChunkStreamImpl.contentType</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                                                                          {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        this.contentType = <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#af452fbad8af098c29a6f0f6a1d2c4c5a">contentType</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        this.contentDisposition = <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a533f24fd9754df388267808b7784b512">contentDisposition</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        this.bufferSize = <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a59ab74694056b1600d983ddade54c626">bufferSize</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        this.open = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a59ab74694056b1600d983ddade54c626"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a59ab74694056b1600d983ddade54c626">org.tdl.vireo.export.impl.ChunkStreamImpl.bufferSize</a></div><div class="ttdeci">final int bufferSize</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00028">ChunkStreamImpl.java:28</a></div></div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a533f24fd9754df388267808b7784b512"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a533f24fd9754df388267808b7784b512">org.tdl.vireo.export.impl.ChunkStreamImpl.contentDisposition</a></div><div class="ttdeci">final String contentDisposition</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00025">ChunkStreamImpl.java:25</a></div></div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_af452fbad8af098c29a6f0f6a1d2c4c5a"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#af452fbad8af098c29a6f0f6a1d2c4c5a">org.tdl.vireo.export.impl.ChunkStreamImpl.contentType</a></div><div class="ttdeci">final String contentType</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00024">ChunkStreamImpl.java:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a0b23dfcf57096c42713079bf1c7d38e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">synchronized void org.tdl.vireo.export.impl.ChunkStreamImpl.close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00069">69</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00098">org.tdl.vireo.export.impl.ChunkStreamImpl.nextChunk()</a>.</p>
<div class="fragment"><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                     {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        this.open = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">nextChunk</a> != null) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            nextChunk.invoke(<span class="keyword">new</span> byte[0]);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a2122fdfd1eb48b770a451b20da35c889"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">org.tdl.vireo.export.impl.ChunkStreamImpl.nextChunk</a></div><div class="ttdeci">synchronized Promise&lt; byte[]&gt; nextChunk()</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00098">ChunkStreamImpl.java:98</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a0b23dfcf57096c42713079bf1c7d38e9_cgraph.png" border="0" usemap="#classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a0b23dfcf57096c42713079bf1c7d38e9_cgraph" alt=""/></div>
<map name="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a0b23dfcf57096c42713079bf1c7d38e9_cgraph" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a0b23dfcf57096c42713079bf1c7d38e9_cgraph">
<area shape="rect" id="node2" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.nextChunk" alt="" coords="216,5,411,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab2f79482a09d7550ee6b32c95c9af079"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void org.tdl.vireo.export.impl.ChunkStreamImpl.flush </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00146">146</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00031">org.tdl.vireo.export.impl.ChunkStreamImpl.chunks</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                        {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">while</span>(!<a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab1c52fe3ab2632b0394f7d0e34ad7c0b">chunks</a>.isEmpty()) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            Thread.yield();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_ab1c52fe3ab2632b0394f7d0e34ad7c0b"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab1c52fe3ab2632b0394f7d0e34ad7c0b">org.tdl.vireo.export.impl.ChunkStreamImpl.chunks</a></div><div class="ttdeci">final ConcurrentLinkedQueue&lt; byte[]&gt; chunks</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00031">ChunkStreamImpl.java:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b858c6f25e8413e77f7a6f9cdb996d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">String org.tdl.vireo.export.impl.ChunkStreamImpl.getContentDisposition </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The "Content-Disposition" header is a way to tell the browser that the data being sent should be saved to disk and not attempt to render it in the browser. The format of this field will be in "[type]; filename=[name]". The possible types are attachment, or inline. Attachments are saved to disk, while inline content is attempted to be rendered in the browser. If the attachment type is used, then an optional parameter may be supplied to suggest the filename for the data.</p>
<dl class="section return"><dt>Returns</dt><dd>The content disposition HTTP header. </dd></dl>

<p>Implements <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1export_1_1_chunk_stream.html#a287eb7471b62eed88eb1566d52a862d4">org.tdl.vireo.export.ChunkStream</a>.</p>

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00064">64</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00025">org.tdl.vireo.export.impl.ChunkStreamImpl.contentDisposition</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                          {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a533f24fd9754df388267808b7784b512">contentDisposition</a>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a533f24fd9754df388267808b7784b512"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a533f24fd9754df388267808b7784b512">org.tdl.vireo.export.impl.ChunkStreamImpl.contentDisposition</a></div><div class="ttdeci">final String contentDisposition</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00025">ChunkStreamImpl.java:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7525dd840127d55ed526dbbfd3ffabd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">String org.tdl.vireo.export.impl.ChunkStreamImpl.getContentType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The "Content-Type" header both helps the webserver and the browser understand the material being streamed. Typically the mimetype of "application/zip" will be used.</p>
<dl class="section return"><dt>Returns</dt><dd>The content type HTTP header. </dd></dl>

<p>Implements <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1export_1_1_chunk_stream.html#aaa65465f3586500d078085600c9a849e">org.tdl.vireo.export.ChunkStream</a>.</p>

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00059">59</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00024">org.tdl.vireo.export.impl.ChunkStreamImpl.contentType</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                   {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#af452fbad8af098c29a6f0f6a1d2c4c5a">contentType</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_af452fbad8af098c29a6f0f6a1d2c4c5a"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#af452fbad8af098c29a6f0f6a1d2c4c5a">org.tdl.vireo.export.impl.ChunkStreamImpl.contentType</a></div><div class="ttdeci">final String contentType</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00024">ChunkStreamImpl.java:24</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a51b84292fe39bf214568aef4b79af00e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boolean org.tdl.vireo.export.impl.ChunkStreamImpl.hasNextChunk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>True if the if the stream is open, or there are events waiting to be consumed. </dd></dl>

<p>Implements <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1export_1_1_chunk_stream.html#a1fa6bab82ca28a5d823e5b9a8304e659">org.tdl.vireo.export.ChunkStream</a>.</p>

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00077">77</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00031">org.tdl.vireo.export.impl.ChunkStreamImpl.chunks</a>, and <a class="el" href="_chunk_stream_impl_8java_source.html#l00037">org.tdl.vireo.export.impl.ChunkStreamImpl.open</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                  {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab1c52fe3ab2632b0394f7d0e34ad7c0b">chunks</a>.isEmpty())</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a0b7a6f5e530d8408c20e6f7c25d82841">open</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">return</span> !chunks.isEmpty();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a0b7a6f5e530d8408c20e6f7c25d82841"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a0b7a6f5e530d8408c20e6f7c25d82841">org.tdl.vireo.export.impl.ChunkStreamImpl.open</a></div><div class="ttdeci">boolean open</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00037">ChunkStreamImpl.java:37</a></div></div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_ab1c52fe3ab2632b0394f7d0e34ad7c0b"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab1c52fe3ab2632b0394f7d0e34ad7c0b">org.tdl.vireo.export.impl.ChunkStreamImpl.chunks</a></div><div class="ttdeci">final ConcurrentLinkedQueue&lt; byte[]&gt; chunks</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00031">ChunkStreamImpl.java:31</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2122fdfd1eb48b770a451b20da35c889"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">synchronized Promise&lt;byte[]&gt; org.tdl.vireo.export.impl.ChunkStreamImpl.nextChunk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>One of two cases, here is what they mean:</p>
<p>1) The queue is empty, but we're sure to get some more chunks pretty soon. So we return an unfulfilled promise for the next chunk. We store a pointer to this promise, so that when we do recieve the next chunk we can add the data to the promise. The consumer will see this and then grab the chunk's data.</p>
<p>2) The queue has a back log of chunks. We just grab the next chunk and hand it over to the consumer. </p>

<p>Implements <a class="el" href="interfaceorg_1_1tdl_1_1vireo_1_1export_1_1_chunk_stream.html#ae195740200e718a008ddc7209dfe01e9">org.tdl.vireo.export.ChunkStream</a>.</p>

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00098">98</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00031">org.tdl.vireo.export.impl.ChunkStreamImpl.chunks</a>.</p>

<p>Referenced by <a class="el" href="_chunk_stream_impl_8java_source.html#l00069">org.tdl.vireo.export.impl.ChunkStreamImpl.close()</a>, and <a class="el" href="_chunk_stream_impl_8java_source.html#l00198">org.tdl.vireo.export.impl.ChunkStreamImpl.synchronizedWrite()</a>.</p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                                                    {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">nextChunk</a> != null)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="stringliteral">&quot;ChunkStream is consuming chunks without waiting for the previous chunk to be consumed.&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab1c52fe3ab2632b0394f7d0e34ad7c0b">chunks</a>.isEmpty()) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="comment">// The queue of chunks is empty right now, so return a promise that</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="comment">// when we get the next one we&#39;ll send the chunk.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">nextChunk</a> = <span class="keyword">new</span> Promise&lt;byte[]&gt;();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">nextChunk</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="comment">// There is a backlog in the queue, so send the chunk.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            Promise&lt;byte[]&gt; <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">nextChunk</a> = <span class="keyword">new</span> Promise&lt;byte[]&gt;();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            nextChunk.invoke(chunks.remove());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">nextChunk</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a2122fdfd1eb48b770a451b20da35c889"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">org.tdl.vireo.export.impl.ChunkStreamImpl.nextChunk</a></div><div class="ttdeci">synchronized Promise&lt; byte[]&gt; nextChunk()</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00098">ChunkStreamImpl.java:98</a></div></div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_ab1c52fe3ab2632b0394f7d0e34ad7c0b"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab1c52fe3ab2632b0394f7d0e34ad7c0b">org.tdl.vireo.export.impl.ChunkStreamImpl.chunks</a></div><div class="ttdeci">final ConcurrentLinkedQueue&lt; byte[]&gt; chunks</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00031">ChunkStreamImpl.java:31</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a2122fdfd1eb48b770a451b20da35c889_icgraph.png" border="0" usemap="#classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a2122fdfd1eb48b770a451b20da35c889_icgraph" alt=""/></div>
<map name="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a2122fdfd1eb48b770a451b20da35c889_icgraph" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a2122fdfd1eb48b770a451b20da35c889_icgraph">
<area shape="rect" id="node2" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a0b23dfcf57096c42713079bf1c7d38e9" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.close" alt="" coords="287,5,449,46"/><area shape="rect" id="node3" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a939d18dc7cfb2af53de90c51ff493e63" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.synchronizedWrite" alt="" coords="249,70,487,111"/><area shape="rect" id="node4" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.writeOrWait" alt="" coords="536,70,736,111"/><area shape="rect" id="node5" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a8fdd75f1603b61239c578b9c3bd046a7" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.write" alt="" coords="784,70,947,111"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a939d18dc7cfb2af53de90c51ff493e63"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">synchronized void org.tdl.vireo.export.impl.ChunkStreamImpl.synchronizedWrite </td>
          <td>(</td>
          <td class="paramtype">byte[]&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td> throws <a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_1_1_buffer_full_exception.html">BufferFullException</a>, IOException</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Internal method for writing chunks into the stream. No one but <a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f">writeOrWait()</a> should call this method. If the buffer is full, then an exception will be thrown for writeOrWait to catch and retry.</p>
<p>Assuming the buffer is fine, the new chunk is added to the queue. Then we check to see if there are any outstanding unfulfilled promise out there. If so, we send the next chunk to that promise so the consumer can now to start reading the stream again.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>The new chunk to be written. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_1_1_buffer_full_exception.html">BufferFullException</a></td><td>When the buffer is full. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00198">198</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00028">org.tdl.vireo.export.impl.ChunkStreamImpl.bufferSize</a>, <a class="el" href="_chunk_stream_impl_8java_source.html#l00031">org.tdl.vireo.export.impl.ChunkStreamImpl.chunks</a>, <a class="el" href="_chunk_stream_impl_8java_source.html#l00098">org.tdl.vireo.export.impl.ChunkStreamImpl.nextChunk()</a>, and <a class="el" href="_chunk_stream_impl_8java_source.html#l00037">org.tdl.vireo.export.impl.ChunkStreamImpl.open</a>.</p>

<p>Referenced by <a class="el" href="_chunk_stream_impl_8java_source.html#l00166">org.tdl.vireo.export.impl.ChunkStreamImpl.writeOrWait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                                                                                      {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a0b7a6f5e530d8408c20e6f7c25d82841">open</a>) </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> IOException(<span class="stringliteral">&quot;Unable to publish chunks into a closed ChunkStream.&quot;</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab1c52fe3ab2632b0394f7d0e34ad7c0b">chunks</a>.size() &gt; <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a59ab74694056b1600d983ddade54c626">bufferSize</a>) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="comment">// The buffer so throw an exception that can be caught by the</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="comment">// nonsynchronized method.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> BufferFullException();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        chunks.offer(event);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">nextChunk</a> != null) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="comment">// A promise already exists, so now that something has been</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="comment">// published into the queue let the consumer know about the new</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="comment">// chunk.</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            nextChunk.invoke(chunks.remove());</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">nextChunk</a> = null;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a0b7a6f5e530d8408c20e6f7c25d82841"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a0b7a6f5e530d8408c20e6f7c25d82841">org.tdl.vireo.export.impl.ChunkStreamImpl.open</a></div><div class="ttdeci">boolean open</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00037">ChunkStreamImpl.java:37</a></div></div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a59ab74694056b1600d983ddade54c626"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a59ab74694056b1600d983ddade54c626">org.tdl.vireo.export.impl.ChunkStreamImpl.bufferSize</a></div><div class="ttdeci">final int bufferSize</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00028">ChunkStreamImpl.java:28</a></div></div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a2122fdfd1eb48b770a451b20da35c889"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889">org.tdl.vireo.export.impl.ChunkStreamImpl.nextChunk</a></div><div class="ttdeci">synchronized Promise&lt; byte[]&gt; nextChunk()</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00098">ChunkStreamImpl.java:98</a></div></div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_ab1c52fe3ab2632b0394f7d0e34ad7c0b"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#ab1c52fe3ab2632b0394f7d0e34ad7c0b">org.tdl.vireo.export.impl.ChunkStreamImpl.chunks</a></div><div class="ttdeci">final ConcurrentLinkedQueue&lt; byte[]&gt; chunks</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00031">ChunkStreamImpl.java:31</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a939d18dc7cfb2af53de90c51ff493e63_cgraph.png" border="0" usemap="#classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a939d18dc7cfb2af53de90c51ff493e63_cgraph" alt=""/></div>
<map name="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a939d18dc7cfb2af53de90c51ff493e63_cgraph" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a939d18dc7cfb2af53de90c51ff493e63_cgraph">
<area shape="rect" id="node2" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.nextChunk" alt="" coords="293,5,488,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a939d18dc7cfb2af53de90c51ff493e63_icgraph.png" border="0" usemap="#classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a939d18dc7cfb2af53de90c51ff493e63_icgraph" alt=""/></div>
<map name="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a939d18dc7cfb2af53de90c51ff493e63_icgraph" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a939d18dc7cfb2af53de90c51ff493e63_icgraph">
<area shape="rect" id="node2" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.writeOrWait" alt="" coords="293,5,493,46"/><area shape="rect" id="node3" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a8fdd75f1603b61239c578b9c3bd046a7" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.write" alt="" coords="541,5,704,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8fdd75f1603b61239c578b9c3bd046a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void org.tdl.vireo.export.impl.ChunkStreamImpl.write </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td> throws IOException</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00119">119</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00166">org.tdl.vireo.export.impl.ChunkStreamImpl.writeOrWait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        byte[] chunk = <span class="keyword">new</span> byte[1];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        chunk[0] = (byte) b;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f">writeOrWait</a>(chunk);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a159d7996f1a9ac5bfd83ce95245ffe6f"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f">org.tdl.vireo.export.impl.ChunkStreamImpl.writeOrWait</a></div><div class="ttdeci">void writeOrWait(byte[] event)</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00166">ChunkStreamImpl.java:166</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a8fdd75f1603b61239c578b9c3bd046a7_cgraph.png" border="0" usemap="#classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a8fdd75f1603b61239c578b9c3bd046a7_cgraph" alt=""/></div>
<map name="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a8fdd75f1603b61239c578b9c3bd046a7_cgraph" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a8fdd75f1603b61239c578b9c3bd046a7_cgraph">
<area shape="rect" id="node2" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.writeOrWait" alt="" coords="216,5,416,46"/><area shape="rect" id="node3" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a939d18dc7cfb2af53de90c51ff493e63" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.synchronizedWrite" alt="" coords="465,5,703,46"/><area shape="rect" id="node4" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.nextChunk" alt="" coords="752,5,947,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aab506d72a80464c94c425b4d4be13c16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void org.tdl.vireo.export.impl.ChunkStreamImpl.write </td>
          <td>(</td>
          <td class="paramtype">byte[]&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td> throws IOException</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00128">128</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00166">org.tdl.vireo.export.impl.ChunkStreamImpl.writeOrWait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                                   {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        byte[] chunk = <span class="keyword">new</span> byte[b.length];</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        System.arraycopy(b, 0, chunk, 0, b.length);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f">writeOrWait</a>(chunk);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a159d7996f1a9ac5bfd83ce95245ffe6f"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f">org.tdl.vireo.export.impl.ChunkStreamImpl.writeOrWait</a></div><div class="ttdeci">void writeOrWait(byte[] event)</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00166">ChunkStreamImpl.java:166</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_aab506d72a80464c94c425b4d4be13c16_cgraph.png" border="0" usemap="#classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_aab506d72a80464c94c425b4d4be13c16_cgraph" alt=""/></div>
<map name="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_aab506d72a80464c94c425b4d4be13c16_cgraph" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_aab506d72a80464c94c425b4d4be13c16_cgraph">
<area shape="rect" id="node2" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.writeOrWait" alt="" coords="216,5,416,46"/><area shape="rect" id="node3" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a939d18dc7cfb2af53de90c51ff493e63" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.synchronizedWrite" alt="" coords="465,5,703,46"/><area shape="rect" id="node4" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.nextChunk" alt="" coords="752,5,947,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a919e029252817ed3af4a6fcff25ec6a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void org.tdl.vireo.export.impl.ChunkStreamImpl.write </td>
          <td>(</td>
          <td class="paramtype">byte[]&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> throws IOException</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00137">137</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00166">org.tdl.vireo.export.impl.ChunkStreamImpl.writeOrWait()</a>.</p>
<div class="fragment"><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                                                     {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        byte[] chunk = <span class="keyword">new</span> byte[len];</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        System.arraycopy(b, off, chunk, 0, len);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f">writeOrWait</a>(chunk);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a159d7996f1a9ac5bfd83ce95245ffe6f"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f">org.tdl.vireo.export.impl.ChunkStreamImpl.writeOrWait</a></div><div class="ttdeci">void writeOrWait(byte[] event)</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00166">ChunkStreamImpl.java:166</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a919e029252817ed3af4a6fcff25ec6a5_cgraph.png" border="0" usemap="#classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a919e029252817ed3af4a6fcff25ec6a5_cgraph" alt=""/></div>
<map name="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a919e029252817ed3af4a6fcff25ec6a5_cgraph" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a919e029252817ed3af4a6fcff25ec6a5_cgraph">
<area shape="rect" id="node2" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a159d7996f1a9ac5bfd83ce95245ffe6f" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.writeOrWait" alt="" coords="216,5,416,46"/><area shape="rect" id="node3" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a939d18dc7cfb2af53de90c51ff493e63" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.synchronizedWrite" alt="" coords="465,5,703,46"/><area shape="rect" id="node4" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.nextChunk" alt="" coords="752,5,947,46"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a159d7996f1a9ac5bfd83ce95245ffe6f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void org.tdl.vireo.export.impl.ChunkStreamImpl.writeOrWait </td>
          <td>(</td>
          <td class="paramtype">byte[]&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td> throws IOException</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Our first internal method to write chunks into the stream. This method will attempt to write the chunk, but if it fails because the buffer is full then it will progressively back of publishing. This is to give the consumer time to catch up. However if after about one minute the consumer hasn't caught up then we assume there's a big problem and blow up with an IO Exception.</p>
<p>Note, this method is not synchronized so that it does not block. The lower level write method synchronizedWrite is.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>The chunk to be written into the stream. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00166">166</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>References <a class="el" href="_chunk_stream_impl_8java_source.html#l00198">org.tdl.vireo.export.impl.ChunkStreamImpl.synchronizedWrite()</a>.</p>

<p>Referenced by <a class="el" href="_chunk_stream_impl_8java_source.html#l00119">org.tdl.vireo.export.impl.ChunkStreamImpl.write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                                {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> attempts = 0; attempts &lt; 350; attempts++) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <span class="comment">// First try to publish with out any overhead</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <a class="code" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a939d18dc7cfb2af53de90c51ff493e63">synchronizedWrite</a>(event);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            } <span class="keywordflow">catch</span> (BufferFullException bfe) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    Thread.sleep(attempts);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                } <span class="keywordflow">catch</span> (InterruptedException ie) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    <span class="comment">// wake up and try to publish again.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">throw</span> <span class="keyword">new</span> IOException(<span class="stringliteral">&quot;ChunkStream buffer is full, the client probably disconnected.&quot;</span>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    }</div>
<div class="ttc" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_html_a939d18dc7cfb2af53de90c51ff493e63"><div class="ttname"><a href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a939d18dc7cfb2af53de90c51ff493e63">org.tdl.vireo.export.impl.ChunkStreamImpl.synchronizedWrite</a></div><div class="ttdeci">synchronized void synchronizedWrite(byte[] event)</div><div class="ttdef"><b>Definition:</b> <a href="_chunk_stream_impl_8java_source.html#l00198">ChunkStreamImpl.java:198</a></div></div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a159d7996f1a9ac5bfd83ce95245ffe6f_cgraph.png" border="0" usemap="#classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a159d7996f1a9ac5bfd83ce95245ffe6f_cgraph" alt=""/></div>
<map name="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a159d7996f1a9ac5bfd83ce95245ffe6f_cgraph" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a159d7996f1a9ac5bfd83ce95245ffe6f_cgraph">
<area shape="rect" id="node2" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a939d18dc7cfb2af53de90c51ff493e63" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.synchronizedWrite" alt="" coords="254,5,493,46"/><area shape="rect" id="node3" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a2122fdfd1eb48b770a451b20da35c889" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.nextChunk" alt="" coords="541,5,736,46"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a159d7996f1a9ac5bfd83ce95245ffe6f_icgraph.png" border="0" usemap="#classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a159d7996f1a9ac5bfd83ce95245ffe6f_icgraph" alt=""/></div>
<map name="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a159d7996f1a9ac5bfd83ce95245ffe6f_icgraph" id="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl_a159d7996f1a9ac5bfd83ce95245ffe6f_icgraph">
<area shape="rect" id="node2" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html#a8fdd75f1603b61239c578b9c3bd046a7" title="org.tdl.vireo.export.impl.\lChunkStreamImpl.write" alt="" coords="253,5,416,46"/></map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a59ab74694056b1600d983ddade54c626"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">final int org.tdl.vireo.export.impl.ChunkStreamImpl.bufferSize</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00028">28</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>Referenced by <a class="el" href="_chunk_stream_impl_8java_source.html#l00051">org.tdl.vireo.export.impl.ChunkStreamImpl.ChunkStreamImpl()</a>, and <a class="el" href="_chunk_stream_impl_8java_source.html#l00198">org.tdl.vireo.export.impl.ChunkStreamImpl.synchronizedWrite()</a>.</p>

</div>
</div>
<a class="anchor" id="ab1c52fe3ab2632b0394f7d0e34ad7c0b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">final ConcurrentLinkedQueue&lt;byte[]&gt; org.tdl.vireo.export.impl.ChunkStreamImpl.chunks = new ConcurrentLinkedQueue&lt;byte[]&gt;()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00031">31</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>Referenced by <a class="el" href="_chunk_stream_impl_8java_source.html#l00146">org.tdl.vireo.export.impl.ChunkStreamImpl.flush()</a>, <a class="el" href="_chunk_stream_impl_8java_source.html#l00077">org.tdl.vireo.export.impl.ChunkStreamImpl.hasNextChunk()</a>, <a class="el" href="_chunk_stream_impl_8java_source.html#l00098">org.tdl.vireo.export.impl.ChunkStreamImpl.nextChunk()</a>, and <a class="el" href="_chunk_stream_impl_8java_source.html#l00198">org.tdl.vireo.export.impl.ChunkStreamImpl.synchronizedWrite()</a>.</p>

</div>
</div>
<a class="anchor" id="a533f24fd9754df388267808b7784b512"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">final String org.tdl.vireo.export.impl.ChunkStreamImpl.contentDisposition</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00025">25</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>Referenced by <a class="el" href="_chunk_stream_impl_8java_source.html#l00051">org.tdl.vireo.export.impl.ChunkStreamImpl.ChunkStreamImpl()</a>, and <a class="el" href="_chunk_stream_impl_8java_source.html#l00064">org.tdl.vireo.export.impl.ChunkStreamImpl.getContentDisposition()</a>.</p>

</div>
</div>
<a class="anchor" id="af452fbad8af098c29a6f0f6a1d2c4c5a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">final String org.tdl.vireo.export.impl.ChunkStreamImpl.contentType</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00024">24</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>Referenced by <a class="el" href="_chunk_stream_impl_8java_source.html#l00051">org.tdl.vireo.export.impl.ChunkStreamImpl.ChunkStreamImpl()</a>, and <a class="el" href="_chunk_stream_impl_8java_source.html#l00059">org.tdl.vireo.export.impl.ChunkStreamImpl.getContentType()</a>.</p>

</div>
</div>
<a class="anchor" id="ab3394937414ecae30edf9ddd659d4b25"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Promise&lt;byte[]&gt; org.tdl.vireo.export.impl.ChunkStreamImpl.nextChunk</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00034">34</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

</div>
</div>
<a class="anchor" id="a0b7a6f5e530d8408c20e6f7c25d82841"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boolean org.tdl.vireo.export.impl.ChunkStreamImpl.open</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_chunk_stream_impl_8java_source.html#l00037">37</a> of file <a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a>.</p>

<p>Referenced by <a class="el" href="_chunk_stream_impl_8java_source.html#l00077">org.tdl.vireo.export.impl.ChunkStreamImpl.hasNextChunk()</a>, and <a class="el" href="_chunk_stream_impl_8java_source.html#l00198">org.tdl.vireo.export.impl.ChunkStreamImpl.synchronizedWrite()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>app/org/tdl/vireo/export/impl/<a class="el" href="_chunk_stream_impl_8java_source.html">ChunkStreamImpl.java</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceorg.html">org</a></li><li class="navelem"><a class="el" href="namespaceorg_1_1tdl.html">tdl</a></li><li class="navelem"><a class="el" href="namespaceorg_1_1tdl_1_1vireo.html">vireo</a></li><li class="navelem"><a class="el" href="namespaceorg_1_1tdl_1_1vireo_1_1export.html">export</a></li><li class="navelem"><a class="el" href="namespaceorg_1_1tdl_1_1vireo_1_1export_1_1impl.html">impl</a></li><li class="navelem"><a class="el" href="classorg_1_1tdl_1_1vireo_1_1export_1_1impl_1_1_chunk_stream_impl.html">ChunkStreamImpl</a></li>
    <li class="footer">Generated on Wed Nov 19 2014 12:49:41 for Vireo by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
