#{extends 'admin.html' /}

#{set 'moreScripts'}
<script type="text/javascript" >
jQuery(document).ready(function(){
	/**
	 * Swap from span to input field and back
	 *
	 *
	 *
	 */
	 jQuery(".edit-box ul li.edit span").live("click", function(){
		if(jQuery(".editing").length == 0){
			
			//Clean up
			jQuery(".tooltip").remove();
			jQuery(this).find(".tooltip-icon").remove();
			jQuery("#backup").remove()
			
			var editItem = jQuery(this);       
			var value = editItem.text().trim();
			
			if(value=="none"){
				value="";
				jQuery("body").append('<div id="backup"></div>')
			} else {
				//Make back up info			
				jQuery("body").append('<div id="backup">'+editItem.html().trim()+'</div>')
			}
			
			//Graduation Semester
			if(editItem.attr("id")=="gradSemester"){
				var markup = '<div id="'+editItem.attr("id")+'" class="editing select">';
				markup += '<select id="gradMonth">';
				markup += jQuery("#gradMonthOptions").html();
				markup += '</select><select id="gradYear">'
				markup += jQuery("#gradYearOptions").html();
				markup += '</select><br /><i class="icon-remove"></i>&nbsp<i class="icon-ok"></i></div>';
				editItem.replaceWith(markup);
				
				jQuery("option").each(function(){
					if(value.indexOf(jQuery(this).text()) >= 0){
						jQuery(this).attr("selected", "selected");
					}
				})
			} else {
			
				//Text Areas
				if(editItem.hasClass("textarea")){
					editItem.replaceWith('<div id="'+editItem.attr("id")+'" class="editing textarea"><textarea class="field" textarea">'+value+'</textarea><br /><i class="icon-remove"></i>&nbsp<i class="icon-ok"></i></div>');
				//Select Drop Downs
				} else if(editItem.hasClass("select")){
					var selectCode = '<div id="'+editItem.attr("id")+'" class="editing select"><select class="field">';
					selectCode += jQuery("#"+editItem.attr("id")+"Options").html();
					selectCode += '</select><br /><i class="icon-remove"></i>&nbsp<i class="icon-ok"></i></div>';
					editItem.replaceWith(selectCode);
					jQuery(".field option").each(function(){
						if(jQuery(this).text()==value){
							jQuery(this).attr("selected","selected");
						}
					})
				//Input Fields
				} else {
					editItem.replaceWith('<div id="'+editItem.attr("id")+'" class="editing"><input class="field" type="text" value="'+value+'" /><br /><i class="icon-remove"></i>&nbsp<i class="icon-ok"></i></div>');
				}
				jQuery(".editing").setTimeout(jQuery(".editing").focus());
			}
		} 
	});
	
	jQuery("#committeeMembers .editCommitteeMember").live("click", function(){
		if(jQuery(".editing").length == 0){
			
			//Clean up
			jQuery(".tooltip").remove();
			jQuery(this).find(".tooltip-icon").remove();
			jQuery("#backup").remove();
			
			//Backup
			jQuery("body").append('<div id="backup">'+jQuery(this).html().trim()+'</div>');
			
			var memberId = jQuery(this).parent("li").attr("class");		
			var firstName = jQuery(this).find(".firstName").text();
			var lastName = jQuery(this).find(".lastName").text();
			var middleName = jQuery(this).find(".middleName").text();
			
			var chair = (jQuery(this).find(".chair").text().trim()=="chair");
			var checked = "";
			if(chair){
				checked = 'checked="checked"';
			}
			
			var markup = '<div class="editing"><table>';
			markup += '<tr><td><b>Last Name</b></td><td><b>First Name</b></td><td><b>Middle Name</b></td><td></td></tr>'
			markup += '<tr>'
			markup += '<td><input id="memberId" class="hidden" type="hidden" value="'+memberId+'" />';
			markup += '<input id="cmLastName" class="span2" type="text" value="'+lastName+'" /></td>';
			markup += '<td><input id="cmFirstName" class="span2" type="text" value="'+firstName+'" /></td>';
			markup += '<td><input id="cmMiddleName" class="span2" type="text" value="'+middleName+'" /></td>';
			markup += '<td><input id="chair" type="checkbox" class="checkbox" '+checked+' > chair</input></td>';
			markup += '</tr>';
			markup += '</table><i class="icon-remove"></i>&nbsp<i class="icon-ok"></i></div>';
			
			jQuery(this).replaceWith(markup);
		}		
	});
		
	jQuery(".icon-ok").live("click", function(){
		var classValue = '';
		var fieldItem;
		var parent = jQuery(this).parent();
		if(jQuery(".editing").hasClass("textarea")){
			classValue = classValue + 'textarea ';
			fieldItem = jQuery(".editing textarea");
		} else if(jQuery(".editing").hasClass("select")){
			classValue = classValue + 'select ';
			fieldItem = jQuery(".editing select");
		} else {
			fieldItem = jQuery(".editing input");
		}
		var id=jQuery(".editing").attr("id");
		var theValue;
		if(fieldItem.val().trim()){
			theValue = fieldItem.val();
		}
		
		var gradSemester;
		var monthValue;
		var yearValue;
		if(parent.attr("id")=="gradSemester"){
			gradSemester = true;
			monthValue = jQuery("#gradMonth").val().trim();
			yearValue = jQuery("#gradYear").val().trim();
		}
		
		var committeeMember;
		var committeeFirstName;
		var committeeLastName;
		var committeeMiddleName;
		var committeeChair;
		var committeeId;
		
		if(jQuery(this).closest("#committeeMembers").length){
			committeeMember = true;
			committeeFirstName = jQuery("#cmFirstName").val().trim();
			committeeLastName = jQuery("#cmLastName").val().trim();
			committeeMiddleName = jQuery("#cmMiddleName").val().trim();
			committeeChair = jQuery("#chair").is(':checked');
			committeeId = jQuery("#memberId").val().trim();
		}
		
		jQuery(".editing").replaceWith('<div class="'+id+' progress progress-striped active"><div class="bar" style="width:100%"></div></div>');
		
		if(gradSemester){
			jQuery.ajax({
				url:'@{ViewTab.updateGraduationDateJSON()}',
				data:{
					subId:'${submission.getId()}',
					month:monthValue,
					year:yearValue
				},
				dataType:'json',
				type:'POST',
				success:function(data){
					var currentValue;
					if(data.value){
						currentValue = nl2br(data.value);
					} else {
						currentValue = "none";
						classValue = classValue + 'empty ';
					}
					
					if(data.success){
						jQuery("div."+id).replaceWith('<span id="'+id+'" class="'+classValue+'"><i class="icon-pencil"></i> '+currentValue+'</span>');
					}
				},
				error:function(){
					jQuery("div."+id).replaceWith('<span id="'+id+'" class="error '+classValue+'">'+jQuery("#backup").html()+' <a href="#" class="tooltip-icon" rel="tooltip" title="There was an error with your request."><div class="badge badge-important"><i class="icon-warning-sign icon-white"></i></div></a></span>');
					jQuery('.tooltip-icon').tooltip();
				}
				
			});
		} else if(committeeMember) {
			jQuery.ajax({
				url:'@{ViewTab.updateCommitteeMemberJSON()}',
				data:{
					id:committeeId,
					firstName:committeeFirstName,
					lastName:committeeLastName,
					middleName:committeeMiddleName,
					chair:committeeChair
				},
				dataType:'json',
				type:'POST',
				success:function(data){	
					if(data.success){
						markup = '<div class="editCommitteeMember">';
						markup += '<span class="lastName">'+data.lastName+'</span><span class="seperator">,&nbsp;</span>';
						markup += '<span class="firstName">'+data.firstName+'&nbsp;</span>';
						markup += '<span class="middleName">'+data.middleName+'&nbsp;</span>';						
						if(data.chair=="true"){
							markup += '<span class="chair label label-info">';
							markup += 'chair';
							markup += '</span>';
						}
						markup += '</div>';
						
						jQuery("li."+data.id).html(markup);
					} else {
						markup = '<div class="editCommitteeMember">';
						markup += '<span class="lastName">'+data.lastName+'</span><span class="seperator">,&nbsp;</span>';
						markup += '<span class="firstName">'+data.firstName+'&nbsp;</span>';
						markup += '<span class="middleName">'+data.middleName+'&nbsp;</span>';						
						if(data.chair=="true"){
							markup += '<span class="chair label label-info">';
							markup += 'chair';
							markup += '</span>';
						}
						markup += '<span><a href="#" class="tooltip-icon" rel="tooltip" title="'+data.message+'"><span class="badge badge-important"><i class="icon-warning-sign icon-white"></i></span></a></span>';
						markup += '</div>';
						
						jQuery("li."+data.id).html(markup);
						jQuery('.tooltip-icon').tooltip();
					}
				},
				error:function(){
					jQuery("div."+id).replaceWith('<span id="'+id+'" class="error '+classValue+'">'+jQuery("#backup").html()+' <a href="#" class="tooltip-icon" rel="tooltip" title="There was an error with your request."><div class="badge badge-important"><i class="icon-warning-sign icon-white"></i></div></a></span>');
					jQuery('.tooltip-icon').tooltip();
				}
				
			});
		} else {
			jQuery.ajax({
				url:'@{ViewTab.updateJSON()}',
				data:{
					subId:'${submission.getId()}',
					field:id,
					value:theValue
				},
				dataType:'json',
				type:'POST',
				success:function(data){
					var currentValue;
					if(data.value){
						currentValue = nl2br(data.value);
					} else {
						currentValue = "none";
						classValue = classValue + 'empty ';
					}
					
					if(data.success){
						jQuery("div."+id).replaceWith('<span id="'+id+'" class="'+classValue+'"><i class="icon-pencil"></i> '+currentValue+'</span>');
						jQuery("#degreeLevel").text(data.degreeLevel);						
					} else {
						jQuery("div."+id).replaceWith('<span id="'+id+'" class="error '+classValue+'"><i class="icon-pencil"></i> '+currentValue+' <a href="#" class="tooltip-icon" rel="tooltip" title="'+data.message+'"><div class="badge badge-important"><i class="icon-warning-sign icon-white"></i></div></a></span>');
						jQuery('.tooltip-icon').tooltip();
					}
				},
				error:function(){
					jQuery("div."+id).replaceWith('<span id="'+id+'" class="error '+classValue+'">'+jQuery("#backup").html()+' <a href="#" class="tooltip-icon" rel="tooltip" title="There was an error with your request."><div class="badge badge-important"><i class="icon-warning-sign icon-white"></i></div></a></span>');
					jQuery('.tooltip-icon').tooltip();
				}
				
			});
		}	
		jQuery("#backup").remove();
		updateActionLog();
		updateLeftColumn();
	});
	
	//Cancel an edit.
	jQuery(".icon-remove").live("click", function(){
		if(jQuery(this).closest("#committeeMembers").length){
			var oldValue = jQuery("#backup").html();			
			var swap = jQuery(".editing");
			swap.removeClass("editing");
			swap.addClass("editCommitteeMember")
			swap.html(oldValue);			
		} else {
			var classValue = '';
			var fieldItem;
			if(jQuery(".editing").hasClass("textarea")){
				classValue = classValue + 'textarea ';
				fieldItem = jQuery(".editing textarea");
			} else if(jQuery(".editing").hasClass("select")){
				classValue = classValue + 'select ';
				fieldItem = jQuery(".editing select");
			} else {
				fieldItem = jQuery(".editing input");
			}
			var id=jQuery(".editing").attr("id");
			
			var currentValue = jQuery("#backup").html();
			
			if(!currentValue){
				currentValue = "none";
				classValue += "empty ";
			}
			
			jQuery(".editing").replaceWith('<span id="'+id+'" class="'+classValue+'"><i class="icon-pencil"></i> '+currentValue+'</span>');
		}
		
		jQuery("#backup").remove();
	});
	
	function updateActionLog(){
		
		jQuery("#actionLog").addClass("waiting");
		
		jQuery.ajax({
			url:'@{ViewTab.refreshActionLogTable()}',
			data:{
				id:'${submission.getId()}'
			},
			dataType:'html',
			type:'POST',
			success:function(data){
				jQuery("#actionLog tbody").replaceWith(data);
				jQuery("#actionLog").removeClass("waiting");
			},
			error:function(){
				alert("Error refreshing Action Log Table.");
			}
			
		});
		
	}
	
	function updateLeftColumn(){
		
		jQuery(".side-box").addClass("waiting");
		
		jQuery.ajax({
			url:'@{ViewTab.refreshLeftColumn()}',
			data:{
				id:'${submission.getId()}'
			},
			dataType:'html',
			type:'POST',
			success:function(data){
				jQuery("#left-column").html(data);
				jQuery(".side-box").removeClass("waiting");
			},
			error:function(){
				alert("Error refreshing Left Column.");
			}
			
		});
		
	}
	
	/**
	 * Function to convert new lines in <br /> tags.
	 */
	function nl2br (str, is_xhtml) {   
		var breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '<br />' : '<br>';    
		return (str + '').replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1'+ breakTag +'$2');
	}
});
</script>
#{/set}

<div id="left-column" class="pull-left">

	#{include 'ViewTab/leftColumn.include' /}	
		
</div>

<div id="right-column">
	<div class="inner">
		<h1>${submission.getStudentLastName()}, ${submission.getStudentFirstName()} (${submission.getMajor()} - ${submission.getDegree()})</h1>
		
		<div class="edit-holder pull-left">
			<ul class="nav nav-tabs">
				<li class="active"><a class="personalInfo" href="#">Personal Info</a></li>
				<li><a class="docInfo" href="#">Document Info</a></li>
				<li><a class="degreeInfo" href="#">Degree Info</a></li>
			</ul>
			<div id="personalInfo" class="edit-box-holder">
			<div class="edit-box pull-left">
				<ul class="unstyled">
					<li class="edit"><label>First Name:</label><span id="firstName"
						#{if submission.getStudentFirstName()}
							><i class="icon-pencil"></i> ${submission.getStudentFirstName()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Middle Name:</label><span id="middleName"
						#{if submission.getStudentMiddleName()}
							><i class="icon-pencil"></i> ${submission.getStudentMiddleName()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>							
					<li class="edit"><label>Last Name:</label><span id="lastName"
						#{if submission.getStudentLastName()}
							><i class="icon-pencil"></i> ${submission.getStudentLastName()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Email:</label><span id="email"
						#{if submitter.getEmail()}
							><i class="icon-pencil"></i> ${submitter.getEmail()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Year of Birth:</label><span id="birthYear"
						#{if submission.getStudentBirthYear()}
							><i class="icon-pencil"></i> ${submission.getStudentBirthYear()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
					</span></li>
				</ul>
			</div>
			<div class="edit-box pull-left">
				<ul class="unstyled">
					<li class="edit"><label>Permanent Phone:</label><span id="permPhone"
						#{if submitter.getPermanentPhoneNumber()}
							><i class="icon-pencil"></i> ${submitter.getPermanentPhoneNumber()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Permanent Email:</label><span id="permEmail"
						#{if submitter.getPermanentEmailAddress()}
							><i class="icon-pencil"></i> ${submitter.getPermanentEmailAddress()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Permanent Address:</label><span id="permAddress"
						#{if submitter.getPermanentPostalAddress()}
							class="textarea"><i class="icon-pencil"></i> ${submitter.getPermanentPostalAddress()}
						#{/if}#{else}
							class="textarea empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Current Phone:</label><span id="currentPhone"
						#{if submitter.getCurrentPhoneNumber()}
							><i class="icon-pencil"></i> ${submitter.getCurrentPhoneNumber()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Current Address:</label><span id="currentAddress"
						#{if submitter.getCurrentPostalAddress()}
							class="textarea"><i class="icon-pencil"></i> ${submitter.getCurrentPostalAddress()}
						#{/if}#{else}
							class="textarea empty"><i class="icon-pencil"></i> none
						#{/else}
					</span></li>
				</ul>
			</div>
			<div class="clear"></div>
			</div>
			
			<div id="docInfo" class="edit-box-holder hidden">
			<div class="edit-box pull-left">
				<ul class="unstyled">
					<li class="edit"><label>Title:</label><span id="title"
						#{if submission.getDocumentTitle()}
							><i class="icon-pencil"></i> ${submission.getDocumentTitle()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Embargo:</label><span id="embargo"
						#{if submission.getEmbargoType()}
							class="select"><i class="icon-pencil"></i> ${submission.getEmbargoType().getName()}
						#{/if}#{else}
							class="select empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>UMI Release:</label><span id="umiRelease"
						#{if submission.getUMIRelease() != null}
							class="select"><i class="icon-pencil"></i> ${submission.getUMIRelease()}
						#{/if}#{else}
							class="select empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Document Type:</label><span id="docType"
						#{if submission.getDocumentType()}
							class="select"><i class="icon-pencil"></i> ${submission.getDocumentType()}
						#{/if}#{else}
							class="select empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Keywords:</label><span id="keywords"
						#{if submission.getDocumentKeywords()}
							class="textarea"><i class="icon-pencil"></i> ${submission.getDocumentKeywords()}
						#{/if}#{else}
							class="textarea empty"><i class="icon-pencil"></i> none
						#{/else}
					</span></li>
				</ul>
			</div>
			<div class="edit-box pull-left">
				<ul class="unstyled">
					<li class="edit"><label>Abstract:</label><span id="abstract"
						#{if submission.getDocumentAbstract()}
							class="textarea"><i class="icon-pencil"></i> ${submission.getDocumentAbstract()}
						#{/if}#{else}
							class="textarea empty"><i class="icon-pencil"></i> none
						#{/else}
					</span></li>
				</ul>
			</div>
			<div class="clear"></div>
			</div>
			
			<div id="degreeInfo" class="edit-box-holder hidden">
			<div class="edit-box pull-left">
				<ul class="unstyled">
					<li class="edit"><label>School:</label><span id="college"
						#{if submission.getCollege()}
							class="select"><i class="icon-pencil"></i> ${submission.getCollege()}
						#{/if}#{else}
							class="select empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Department:</label><span id="department"
						#{if submission.getDepartment()}
							class="select"><i class="icon-pencil"></i> ${submission.getDepartment()}
						#{/if}#{else}
							class="select empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Degree:</label><span id="degree"
						#{if submission.getDegree()}
							class="select"><i class="icon-pencil"></i> ${submission.getDegree()}
						#{/if}#{else}
							class="select empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li><label>Degree Level:</label><span id="degreeLevel"
						#{if submission.getDegree()}
							class="select">${degreeLevel}
						#{/if}#{else}
							class="select empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Major:</label><span id="major"
						#{if submission.getMajor()}
							class="select"><i class="icon-pencil"></i> ${submission.getMajor()}
						#{/if}#{else}
							class="select empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Graduation Semester:</label><span id="gradSemester"
						#{if submission.getGraduationMonth() && submission.getGraduationYear()}
							class="select"><i class="icon-pencil"></i> ${gradMonth} ${submission.getGraduationYear()}
						#{/if}#{else}
							class="select empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li class="edit"><label>Advisor Email:</label><span id="advisorEmail"
						#{if submission.getCommitteeContactEmail()}
							><i class="icon-pencil"></i> ${submission.getCommitteeContactEmail()}
						#{/if}#{else}
							class="empty"><i class="icon-pencil"></i> none
						#{/else}
						</span></li>
					<li><label></label><span><button class="btn">Send Advisor Approval Email</button></span></li>
				</ul>				
			</div>
			<div id="committeeMembers" class="edit-box pull-left">				
				<ul class="unstyled">
					<li><i class="icon-pencil"></i> <b>Committee Members:</b>
					<ul class="unstyled" style="padding:10px 0 0 30px;">
					#{if submission.getCommitteeMembers()}
					#{list items:submission.getCommitteeMembers(), as:'value'}
						
						<li class="${value.getId()}">
							<div class="editCommitteeMember">
								<span class="lastName">${value.getLastName()}</span><span class="seperator">,</span>
								<span class="firstName">${value.getFirstName()}</span> 
								<span class="middleName">${value.getMiddleName()}</span>
								#{if value.isCommitteeChair()}
								<span class="chair label label-info">chair</span>
								#{/if}
							</div>
						</li>
						
					#{/list}
					
					#{/if}
					#{else}
					<li class="empty">none</li>
					#{/else}
					</ul></li>
				</ul>				
			</div>
			<div class="clear"></div>
			</div>
			
			<!-- Hidden Select Options -->
			<div id="embargoOptions" style="display:none;">
				#{list items:settingRepo.findAllEmbargoTypes(), as:'embargo'}
					<option value="${embargo.getId()}">${embargo.getName()}</option>
				#{/list}
			</div>
			<div id="umiReleaseOptions" style="display:none;">
				<option value="true">true</option>
				<option value="false">false</option>
			</div>
			<div id="docTypeOptions" style="display:none;">
				#{list items:settingRepo.findAllDocumentTypes(), as:'docType'}
					<option value="${docType.getName()}">${docType.getName()} - ${docType.getLevel()}</option>
				#{/list}
			</div>
			<div id="collegeOptions" style="display:none;">
				#{list items:settingRepo.findAllColleges(), as:'college'}
					<option value="${college.getName()}">${college.getName()}</option>
				#{/list}
			</div>
			<div id="departmentOptions" style="display:none;">
				#{list items:settingRepo.findAllDepartments(), as:'department'}
					<option value="${department.getName()}">${department.getName()}</option>
				#{/list}
			</div>
			<div id="degreeOptions" style="display:none;">
				#{list items:settingRepo.findAllDegrees(), as:'degree'}
					<option value="${degree.getName()}">${degree.getName()}</option>
				#{/list}
			</div>
			<div id="majorOptions" style="display:none;">
				#{list items:settingRepo.findAllMajors(), as:'major'}
					<option value="${major.getName()}">${major.getName()}</option>
				#{/list}
			</div>
			
			<div id="gradMonthOptions" style="display:none;">
				<option value="4">May</option>
				<option value="7">August</option>
				<option value="11">December</option>
			</div>
			<div id="gradYearOptions" style="display:none;">
				<option value="2006">2006</option>
				<option value="2007">2007</option>
				<option value="2008">2008</option>
				<option value="2009">2009</option>
				<option value="2010">2010</option>
				<option value="2011">2011</option>
				<option value="2012">2012</option>
				<option value="2013">2013</option>
			</div>
			
		</div>
		
		<h2>ACTION LOG</h2>
		<table id="actionLog" class="table table-striped table-bordered table-condensed">
			<thead>
				<tr>
					<td>Action by</td>
					<td>Action / Comment</td>
					<td>Time</td>
				</tr>
			</thead>
			#{include 'ViewTab/actionLogTable.include' /}
		</table>
		
		<h2>ALL FILES</h2>
		<table class="table table-striped table-bordered table-condensed">
			<thead>
				<tr>
					<td>Name</td>
					<td>File</td>
					<td>Type</td>
					<td>Time</td>
				</tr>
			</thead>
			<tbody>
				#{list items:submission.getAttachments(), as:'attachment'}
					<tr>
						<td></td>
						<td><a href="${attachment.getFile()}">${attachment.getName()}</a> (${attachment.getDisplaySize()})</td>
						<td>${attachment.getType()}</td>
						<td></td>
					</tr>
				#{/list}				
				<tr>
					<td colspan="4" class="comments tr"><button class="btn btn-small">Add File</button></td>
				</tr>
			</tbody>
		</table>
	</div>
</div>

#{include 'ViewTab/dialogs.include' /}