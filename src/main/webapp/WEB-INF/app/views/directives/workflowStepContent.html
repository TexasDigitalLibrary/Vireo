<div class="row" ng-if="step.overrideable || step.originatingOrganization == selectedOrganization.id">
			
	<div class="col-md-6">
  		<textField
  			class="workflowstep-edit-name" 
			label="Workflow Step Name:" 
			scope-value="step.name"
			hint="'My Workflow Step's name'"
			on-blur="updateWorkflowStep(step)">
		</textField>
  	</div>

	<div class="col-md-3">
  		<toggleButton 
			label="Workflow Step is Overridable:"
			scope-value="step.overrideable"
			toggle-options='[{"true": "Yes"},{"false": "No"}]'
			ng-click="updateWorkflowStep(step)">
		</toggleButton>
	</div>

  	<div class="col-md-3">
  		<div class="form-group">
  			<button class="btn btn-danger" ng-click="openConfirmDeleteModal(step)">Delete Workflow Step</button>
			<modal modal-id="workflow-step-delete-confirm-{{step.id}}" modal-view="views/modals/workflowStepDeleteModal.html" modal-header-class="modal-header-danger"></modal>
  		</div>
  	</div>

	<hr>

</div>


<div ng-controller="FieldProfileManagementController">

	<div ng-if="step.overrideable || step.originatingOrganization == selectedOrganization.id">
		
		<div id="fieldProfiles" class="row">

			<alerts channels="/organization/workflowStep/fieldProfiles" types="ERROR, WARNING" exclusive></alerts>

			<div class="col-sm-6">		
				
				<button class="btn btn-default modal-add-btn" ng-click="openNewModal(step.id)">
					Add Field Profile
				</button>

				<div class="glyphicon glyphicon-info-sign tooltip-span move-up" tooltip="Dialog in which allows to create new field profile."></div>

				<p ng-if="step.aggregateFieldProfiles.length == 0">Add New Field Profile</p>
				 
				<draganddroplist dragging="dragging"
								 scope-value="step.aggregateFieldProfiles"
								 properties='["fieldGlosses"]'
								 item-view='views/directives/dragAndDropFieldProfile.html'
								 listeners='dragControlListeners'
								 edit='editFieldProfile(index)'
								 is-editable='isEditable(fieldProfile)'>
				</draganddroplist>
		 		
			</div>

			<div class="col-sm-6">
				<trashcan id="field-profile-trash-{{step.id}}"
						  dragging="dragging"
						  listeners='dragControlListeners'>
				</trashcan>
			</div>

			<modal modal-id="fieldProfilesNewModal-{{step.id}}" 
				   modal-view="views/modals/organization/fieldProfilesNewModal.html" 
				   modal-header-class="modal-header-primary"
				   modal-keyboard="false"
				   modal-backdrop="static">
			</modal>
		 
			<modal modal-id="fieldProfilesEditModal-{{step.id}}"  
				   modal-view="views/modals/organization/fieldProfilesEditModal.html" 
				   modal-header-class="modal-header-primary"
				   modal-keyboard="false"
				   modal-backdrop="static">
			</modal>
		 
			<modal modal-id="fieldProfilesConfirmRemoveModal-{{step.id}}" 
				   modal-view="views/modals/organization/fieldProfilesConfirmRemoveModal.html" 
				   modal-header-class="modal-header-danger"
				   modal-keyboard="false"
				   modal-backdrop="static">
			</modal>

		</div>
	</div>

	<div ng-if="!step.overrideable && step.originatingOrganization != selectedOrganization.id">
		<h3>Read only. Workflow step is non overrideable.</h3>
		<ul class="list-unstyled">
		   <li ng-repeat="fieldProfile in step.aggregateFieldProfiles">
		      	{{fieldProfile.position}}. {{fieldProfile.fieldGlosses[0].value}}
		   </li>
		</ul>
	</div>

</div>

<hr>

<div ng-controller="NoteManagementController">

	<div ng-if="step.overrideable || step.originatingOrganization == selectedOrganization.id">

		<div id="notes" class="row">

			<alerts channels="/organization/workflowStep/notes" types="ERROR, WARNING" exclusive></alerts>

			<div class="col-sm-6">		
				
				<button class="btn btn-default modal-add-btn" ng-click="openNewModal(step.id)">
					Add Note
				</button>
				
				<div class="glyphicon glyphicon-info-sign tooltip-span move-up" tooltip="Dialog in which allows to create new note."></div>

				<p ng-if="step.aggregateNotes.length == 0">Add New Note</p>
				 
				<draganddroplist dragging="dragging"
								 scope-value="step.aggregateNotes"
								 properties='["name"]'
								 item-view='views/directives/dragAndDropNote.html'
								 listeners='dragControlListeners'
								 edit='editNote(index)'
								 is-editable='isEditable(note)'>
				</draganddroplist>
		 		
			</div>


			
			<div class="col-sm-6">
				<trashcan id="note-trash-{{step.id}}"
						  dragging="dragging"
						  listeners='dragControlListeners'>
				</trashcan>
			</div>

			<modal modal-id="notesNewModal-{{step.id}}" 
				   modal-view="views/modals/organization/notesNewModal.html" 
				   modal-header-class="modal-header-primary"
				   modal-keyboard="false"
				   modal-backdrop="static">
			</modal>
		 
			<modal modal-id="notesEditModal-{{step.id}}"  
				   modal-view="views/modals/organization/notesEditModal.html" 
				   modal-header-class="modal-header-primary"
				   modal-keyboard="false"
				   modal-backdrop="static">
			</modal>
		 
			<modal modal-id="notesConfirmRemoveModal-{{step.id}}" 
				   modal-view="views/modals/organization/notesConfirmRemoveModal.html" 
				   modal-header-class="modal-header-danger"
				   modal-keyboard="false"
				   modal-backdrop="static">
			</modal>

		</div>
	</div>

	<div ng-if="!step.overrideable && step.originatingOrganization != selectedOrganization.id">
		<h3>Read only. Workflow step is non overrideable.</h3>
		<ul class="list-unstyled">
		   <li ng-repeat="note in step.aggregateNotes">
		      	{{note.position}}. {{note.name}}
		   </li>
		</ul>
	</div>

</div>

